{
  "contentVersion": "1.0.0.0",
  "parameters": {
    "workbookDisplayName": {
      "type": "string",
      "defaultValue": "EASM Workbook",
      "metadata": {
        "description": "The friendly name for the workbook that is used in the Gallery or Saved List.  This name must be unique within a resource group."
      }
    },
    "workbookType": {
      "type": "string",
      "defaultValue": "workbook",
      "metadata": {
        "description": "The gallery that the workbook will been shown under. Supported values include workbook, tsg, sentinel. Usually, this is 'workbook'"
      }
    },
    "logAnalyticsWorkspace": {
      "type": "string",
      "defaultValue": "",
      "metadata": {
        "description": "The name of the Log Analytics workspace to which this workbook will be associated"
      }
    },
    "logAnalyticsResourceGroup": {
      "type": "string",
      "defaultValue": "",
      "metadata": {
        "description": "The Resource Group of the Log Analytics workspace to which this workbook will be associated"
      }
    },
    "workbookId": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "metadata": {
        "description": "The unique guid for this workbook instance"
      }
    }
  },
  "variables": {
    "workbookSourceId": "[resourceId(trim(parameters('logAnalyticsResourceGroup')), 'microsoft.operationalinsights/workspaces', trim(parameters('logAnalyticsWorkspace')))]"
  },
  "resources": [
    {
      "name": "[parameters('workbookId')]",
      "type": "microsoft.insights/workbooks",
      "location": "[resourceGroup().location]",
      "apiVersion": "2021-03-08",
      "dependsOn": [],
      "kind": "shared",
      "properties": {
        "displayName": "[parameters('workbookDisplayName')]",
        "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"91db5e45-3e81-4fdd-838f-78392f725682\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_workbook_layout\",\"label\":\"Workbook Layout\",\"type\":10,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"Tabbed\\\",\\\"Single Page\\\"]\",\"value\":\"Tabbed\"},{\"id\":\"63f093d6-7fff-49c7-be5c-b5ae4ab28bb0\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_workbook_source\",\"label\":\"Workbook Data Source\",\"type\":10,\"description\":\"Select the data source for this workbook\",\"isRequired\":true,\"isGlobal\":true,\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"jsonData\":\"[\\\"Log Analytics\\\",\\\"Azure Data Explorer\\\"]\",\"timeContext\":{\"durationMs\":86400000},\"value\":\"Azure Data Explorer\"}],\"style\":\"above\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"customWidth\":\"30\",\"name\":\"WorkbookOptions\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"64eb843a-d545-440c-9776-b61f3b9c7225\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_cluster_uri\",\"label\":\"ADX Cluster URI\",\"type\":1,\"description\":\"https://__cluster_name__.__cluster_region__.kusto.windows.net\",\"isRequired\":true,\"isGlobal\":true,\"timeContext\":{\"durationMs\":86400000},\"value\":\"\"},{\"id\":\"5b5b5fa5-5a5a-45ba-9374-5b35193c4192\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_database_name\",\"label\":\"ADX Database Name\",\"type\":1,\"description\":\"__database_name__\",\"isRequired\":true,\"isGlobal\":true,\"timeContext\":{\"durationMs\":86400000},\"value\":\"\"},{\"id\":\"6736f8d1-7ac2-42db-91ea-31e78d435b93\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_workspace_name\",\"label\":\"EASM Workspace Name\",\"type\":2,\"isRequired\":true,\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"EasmAsset\\\\r\\\\n|summarize by WorkspaceName\\\\r\\\\n|order by WorkspaceName asc\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"timeContext\":{\"durationMs\":86400000},\"queryType\":9,\"value\":\"pepsico18mar\"},{\"id\":\"b5b5729c-1a7b-4465-8673-cdfcc6073731\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_lastseen\",\"label\":\"Last Seen Within\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}],\"allowCustom\":true},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":2592000000}},{\"id\":\"bd8327e7-6805-4c87-8388-47ad68fb69a7\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_oldest_snapshot\",\"type\":2,\"isRequired\":true,\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"//initial data dump from connector often brings over initial easm workspace data that is not very accurate\\\\r\\\\n//so if there is more than 1 snapshot, we will exclude that first data dump from most queries via the _adx_oldest_snapshot parameter, otherwise we will use a dummy datetime so that the dashboards still populate data\\\\r\\\\nlet workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|summarize snapshots=make_set(SnapshotDateTime) by WorkspaceName\\\\r\\\\n|extend oldest = iff(array_length(snapshots) > 1, todatetime(strcat_array(array_slice(array_sort_asc(snapshots),0,0),'')),todatetime('1970-01-01 00:00:00'))\\\\r\\\\n|project oldest\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"isHiddenWhenLocked\":true,\"typeSettings\":{\"additionalResourceOptions\":[\"value::1\"],\"showDefault\":false},\"defaultValue\":\"value::1\",\"queryType\":9}],\"style\":\"above\",\"doNotRunWhenHidden\":true,\"queryType\":9},\"customWidth\":\"60\",\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},\"name\":\"ADXClusterParameters\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"f7c71b4f-116f-4866-bab5-a82909d0fc46\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_workspace\",\"label\":\"Log Analytics Workspace\",\"type\":5,\"isRequired\":true,\"isGlobal\":true,\"typeSettings\":{\"resourceTypeFilter\":{\"microsoft.operationalinsights/workspaces\":true},\"additionalResourceOptions\":[]},\"timeContext\":{\"durationMs\":86400000},\"value\":\"\"},{\"id\":\"f7320109-da82-4eca-9f94-c6256c8a405f\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_workspace_name\",\"label\":\"EASM Workspace Name\",\"type\":2,\"isRequired\":true,\"query\":\"EasmAsset_CL\\r\\n|summarize by WorkspaceName_s\\r\\n|order by WorkspaceName_s asc\",\"crossComponentResources\":[\"{_la_workspace}\"],\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"value\":null},{\"id\":\"95d506d7-3730-4a94-813a-e9065a6ca448\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_lastseen\",\"label\":\"Last Seen Within\",\"type\":4,\"isRequired\":true,\"typeSettings\":{\"selectableValues\":[{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":259200000},{\"durationMs\":604800000},{\"durationMs\":1209600000},{\"durationMs\":2419200000},{\"durationMs\":2592000000},{\"durationMs\":5184000000},{\"durationMs\":7776000000}],\"allowCustom\":true},\"timeContext\":{\"durationMs\":86400000},\"value\":{\"durationMs\":2592000000}},{\"id\":\"9ef8f492-9d49-4314-b6c1-1d2286153f33\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_oldest_snapshot\",\"type\":2,\"isRequired\":true,\"query\":\"//initial data dump from connector often brings over initial easm workspace data that is not very accurate\\r\\n//so if there is more than 1 snapshot, we will exclude that first data dump from most queries via the _la_oldest_snapshot parameter, otherwise we will use a dummy datetime so that the dashboards still populate data\\r\\nlet workspace = '{_la_workspace_name}';\\r\\nEasmAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|summarize snapshots=make_set(SnapshotDateTime_t) by WorkspaceName_s\\r\\n|extend oldest = iff(array_length(snapshots) > 1, todatetime(strcat_array(array_slice(array_sort_asc(snapshots),0,0),'')),todatetime('1970-01-01 00:00:00'))\\r\\n|project oldest\",\"isHiddenWhenLocked\":true,\"typeSettings\":{\"additionalResourceOptions\":[\"value::1\"],\"showDefault\":false},\"defaultValue\":\"value::1\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"}],\"style\":\"above\",\"doNotRunWhenHidden\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"customWidth\":\"60\",\"conditionalVisibility\":{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},\"name\":\"LAWorkspaceParameters\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"tabs\",\"links\":[{\"id\":\"ae5e4d7f-fecd-4edd-87f7-cac826026f20\",\"cellValue\":\"_adx_tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Summary\",\"subTarget\":\"ADX Workspace Summary\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"4f763408-9232-4753-9d5e-34d3b4563751\",\"cellValue\":\"_adx_tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Risk Findings\",\"subTarget\":\"ADX Risk Findings\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"151e3efa-51b3-4b88-87a8-9c3062c62066\",\"cellValue\":\"_adx_tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"CVEs\",\"subTarget\":\"ADX CVEs\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"036bc557-220f-4809-a51f-a26d8643823f\",\"cellValue\":\"_adx_tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Web Components\",\"subTarget\":\"ADX Web Components\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"94064321-9a85-4566-866d-e3d8ccc72f87\",\"cellValue\":\"_adx_tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Hosts\",\"subTarget\":\"ADX Host Details\",\"style\":\"primary\"},{\"id\":\"e89a181c-eda4-44cd-b8b3-5c97d558ab42\",\"cellValue\":\"_adx_tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"IPs\",\"subTarget\":\"ADX IP Address Details\",\"style\":\"primary\"},{\"id\":\"759080c3-5a88-4e7f-94c7-54f2c0f6c52b\",\"cellValue\":\"_adx_tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Pages\",\"subTarget\":\"ADX Page Details\",\"style\":\"primary\"},{\"id\":\"aab5da0a-6a44-4bea-9302-bbcb203e3226\",\"cellValue\":\"_adx_tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Certificates\",\"subTarget\":\"ADX SSL Certificate Details\",\"style\":\"primary\"},{\"id\":\"9ad25949-e564-430d-a500-e2c1361b7194\",\"cellValue\":\"_adx_tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Domains\",\"subTarget\":\"ADX Domain Details\",\"style\":\"primary\"}]},\"conditionalVisibilities\":[{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},{\"parameterName\":\"_workbook_layout\",\"comparison\":\"isEqualTo\",\"value\":\"Tabbed\"}],\"name\":\"ADX Tab Menu\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"tabs\",\"links\":[{\"id\":\"a17b3490-177f-4c5a-a7c2-eb340563296b\",\"cellValue\":\"_la_tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Summary\",\"subTarget\":\"LA Workspace Summary\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"d490f57e-6164-4733-856c-73dd2c89c4ce\",\"cellValue\":\"_la_tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Risk Findings\",\"subTarget\":\"LA Risk Findings\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"9cd848ad-719b-4288-b206-c1f982eac1f4\",\"cellValue\":\"_la_tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"CVEs\",\"subTarget\":\"LA CVEs\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"7534a644-5ee3-45fe-8f55-ded835690a81\",\"cellValue\":\"_la_tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Web Components\",\"subTarget\":\"LA Web Components\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"10470c5d-009d-4fa3-8aa1-ea8a46e80311\",\"cellValue\":\"_la_tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Hosts\",\"subTarget\":\"LA Host Details\",\"style\":\"primary\"},{\"id\":\"0b3e3193-018c-4ee8-9c5b-0054997a211f\",\"cellValue\":\"_la_tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"IPs\",\"subTarget\":\"LA IP Address Details\",\"style\":\"primary\"},{\"id\":\"4743bb83-f506-4b37-a669-dd5eff2def01\",\"cellValue\":\"_la_tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Pages\",\"subTarget\":\"LA Page Details\",\"style\":\"primary\"},{\"id\":\"863add5e-5905-4c96-a32b-9eb0f0a9b442\",\"cellValue\":\"_la_tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Certificates\",\"subTarget\":\"LA SSL Certificate Details\",\"style\":\"primary\"},{\"id\":\"0324649a-8971-4b50-a63b-aaf016012445\",\"cellValue\":\"_la_tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Domains\",\"subTarget\":\"LA Domain Details\",\"style\":\"primary\"}]},\"conditionalVisibilities\":[{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},{\"parameterName\":\"_workbook_layout\",\"comparison\":\"isEqualTo\",\"value\":\"Tabbed\"}],\"name\":\"LA Tab Menu\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"ab758bf7-6409-4346-beb5-2656ccd19828\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_layout\",\"type\":1,\"isHiddenWhenLocked\":true,\"criteriaData\":[{\"criteriaContext\":{\"leftOperand\":\"_workbook_layout\",\"operator\":\"==\",\"rightValType\":\"static\",\"rightVal\":\"Tabbed\",\"resultValType\":\"static\",\"resultVal\":\"{_la_tab}\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"resultValType\":\"static\",\"resultVal\":\"all\"}}],\"timeContext\":{\"durationMs\":86400000}},{\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_layout\",\"type\":1,\"isHiddenWhenLocked\":true,\"criteriaData\":[{\"criteriaContext\":{\"leftOperand\":\"_workbook_layout\",\"operator\":\"==\",\"rightValType\":\"static\",\"rightVal\":\"Tabbed\",\"resultValType\":\"static\",\"resultVal\":\"{_adx_tab}\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"resultValType\":\"static\",\"resultVal\":\"all\"}}],\"timeContext\":{\"durationMs\":86400000},\"id\":\"c9a44b5d-57f6-4f50-871f-8d317d094402\"}],\"style\":\"above\",\"doNotRunWhenHidden\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"customWidth\":\"20\",\"name\":\"singlePage or multiTab\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"nav\",\"links\":[{\"id\":\"ae5e4d7f-fecd-4edd-87f7-cac826026f20\",\"cellValue\":\"ADX Workspace Summary\",\"linkTarget\":\"step\",\"linkLabel\":\"Summary\",\"preText\":\"Navigation Menu  ||\",\"style\":\"primary\"},{\"id\":\"4f763408-9232-4753-9d5e-34d3b4563751\",\"cellValue\":\"ADX Risk Findings\",\"linkTarget\":\"step\",\"linkLabel\":\"Risk Findings\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"151e3efa-51b3-4b88-87a8-9c3062c62066\",\"cellValue\":\"ADX CVEs\",\"linkTarget\":\"step\",\"linkLabel\":\"CVEs\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"61df8165-c4b3-4ee3-ab03-73d2e84296a5\",\"cellValue\":\"ADX Web Components\",\"linkTarget\":\"step\",\"linkLabel\":\"Web Components\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"94064321-9a85-4566-866d-e3d8ccc72f87\",\"cellValue\":\"ADX Host Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Hosts\",\"style\":\"primary\"},{\"id\":\"e89a181c-eda4-44cd-b8b3-5c97d558ab42\",\"cellValue\":\"ADX IP Address Details\",\"linkTarget\":\"step\",\"linkLabel\":\"IPs\",\"style\":\"primary\"},{\"id\":\"759080c3-5a88-4e7f-94c7-54f2c0f6c52b\",\"cellValue\":\"ADX Page Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Pages\",\"style\":\"primary\"},{\"id\":\"aab5da0a-6a44-4bea-9302-bbcb203e3226\",\"cellValue\":\"ADX SSL Certificate Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Certificates\",\"style\":\"primary\"},{\"id\":\"9ad25949-e564-430d-a500-e2c1361b7194\",\"cellValue\":\"ADX Domain Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Domains\",\"style\":\"primary\"}]},\"conditionalVisibilities\":[{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},{\"parameterName\":\"_workbook_layout\",\"comparison\":\"isEqualTo\",\"value\":\"Single Page\"}],\"name\":\"ADX Navigation Menu\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"nav\",\"links\":[{\"id\":\"a17b3490-177f-4c5a-a7c2-eb340563296b\",\"cellValue\":\"LA Workspace Summary\",\"linkTarget\":\"step\",\"linkLabel\":\"Summary\",\"preText\":\"Navigation Menu  ||\",\"style\":\"primary\"},{\"id\":\"d490f57e-6164-4733-856c-73dd2c89c4ce\",\"cellValue\":\"LA Risk Findings\",\"linkTarget\":\"step\",\"linkLabel\":\"Risk Findings\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"9cd848ad-719b-4288-b206-c1f982eac1f4\",\"cellValue\":\"LA CVEs\",\"linkTarget\":\"step\",\"linkLabel\":\"CVEs\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"975ee71b-bf6f-4176-a4d9-20bd5376415e\",\"cellValue\":\"LA Web Components\",\"linkTarget\":\"step\",\"linkLabel\":\"Web Components\",\"preText\":\"\",\"style\":\"primary\"},{\"id\":\"10470c5d-009d-4fa3-8aa1-ea8a46e80311\",\"cellValue\":\"LA Host Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Hosts\",\"style\":\"primary\"},{\"id\":\"0b3e3193-018c-4ee8-9c5b-0054997a211f\",\"cellValue\":\"LA IP Address Details\",\"linkTarget\":\"step\",\"linkLabel\":\"IPs\",\"style\":\"primary\"},{\"id\":\"4743bb83-f506-4b37-a669-dd5eff2def01\",\"cellValue\":\"LA Page Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Pages\",\"style\":\"primary\"},{\"id\":\"863add5e-5905-4c96-a32b-9eb0f0a9b442\",\"cellValue\":\"LA SSL Certificate Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Certificates\",\"style\":\"primary\"},{\"id\":\"0324649a-8971-4b50-a63b-aaf016012445\",\"cellValue\":\"LA Domain Details\",\"linkTarget\":\"step\",\"linkLabel\":\"Domains\",\"style\":\"primary\"}]},\"conditionalVisibilities\":[{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},{\"parameterName\":\"_workbook_layout\",\"comparison\":\"isEqualTo\",\"value\":\"Single Page\"}],\"name\":\"LA Navigation Menu\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"Workspace Summary\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n|summarize Count=count() by AssetType\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":4,\"showAnalytics\":true,\"title\":\"Asset Types\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"AssetType\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"useGrouping\":false,\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":true,\"sortOrderField\":2,\"size\":\"auto\"}},\"customWidth\":\"87\",\"name\":\"ADX Asset Types\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n|extend TotalCount = 'Total'\\\\r\\\\n|summarize Total=count() by TotalCount\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":4,\"showAnalytics\":true,\"title\":\"Asset Count\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"TotalCount\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Total\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"useGrouping\":false,\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":true,\"sortOrderField\":2,\"size\":\"auto\"}},\"customWidth\":\"13\",\"name\":\"ADX Asset Count\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|summarize Count=count() by AssetType,SnapshotDateTime\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"aggregation\":5,\"showAnnotations\":true,\"showAnalytics\":true,\"title\":\"Asset Types Over Time\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"timechart\",\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AssetType\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}}},\"customWidth\":\"60\",\"name\":\"ADX Asset Types Over Time\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmIpAddressAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n|where array_length(Locations) > 0\\\\r\\\\n|union kind=inner (EasmHostAsset\\\\r\\\\n    |where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n    |where array_length(Locations) > 0)\\\\r\\\\n|project-keep Locations,AssetName\\\\r\\\\n|mv-expand Locations\\\\r\\\\n//|extend Region = tostring(Locations.Region), City = tostring(Locations.City), Latitude = toreal(Locations.Latitude), Longitude = toreal(Locations.Longitude), LocationLastSeen = todatetime(Locations.LastSeen), LocationFirstSeen = todatetime(Locations.FirstSeen)\\\\r\\\\n|extend Region = tostring(Locations.Region), City = tostring(Locations.City), Latitude = toreal(Locations.Latitude), Longitude = toreal(Locations.Longitude)\\\\r\\\\n|where isnotempty(Latitude) and isnotempty(Longitude) and isnotempty(Region) and isnotempty(City)\\\\r\\\\n|summarize Count=count() by Latitude,Longitude,Region,City\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"Asset Locations\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"map\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"Region\",\"formatter\":1},\"subtitleContent\":{\"columnMatch\":\"City\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"}},\"showBorder\":false,\"sortCriteriaField\":\"Count\",\"sortOrderField\":2,\"size\":\"auto\"},\"mapSettings\":{\"locInfo\":\"LatLong\",\"locInfoColumn\":\"City\",\"latitude\":\"Latitude\",\"longitude\":\"Longitude\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Max\",\"maxSize\":70,\"opacity\":0.7,\"labelSettings\":\"City\",\"legendMetric\":\"Count\",\"numberOfMetrics\":20,\"legendAggregation\":\"Max\",\"itemColorSettings\":{\"nodeColorField\":\"Count\",\"colorAggregation\":\"Max\",\"type\":\"heatmap\",\"heatmapPalette\":\"categorical\"}}},\"customWidth\":\"40\",\"name\":\"ADX Asset Locations\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"92020e51-938f-4494-91af-80caea4acaff\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_port_summary\",\"label\":\"Ports Summary\",\"type\":10,\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"jsonData\":\"[\\\"By System\\\",\\\"By Port\\\"]\",\"timeContext\":{\"durationMs\":86400000},\"value\":null},{\"id\":\"95a2aeca-1b0a-413e-b7b2-b8e6a151cb03\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_system_type\",\"label\":\"Ports System Types\",\"type\":10,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"jsonData\":\"[\\\"All\\\",\\\"IPs Only\\\",\\\"Hosts Only\\\"]\",\"timeContext\":{\"durationMs\":86400000},\"value\":\"All\"},{\"id\":\"e28addca-dc23-4e48-b4b9-211fc259b52c\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_has_banner\",\"label\":\"Has Banner?\",\"type\":10,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"Yes\\\"]\",\"value\":null},{\"id\":\"90b75bbd-3440-4d59-96c4-1ebdaae52504\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_port_sort\",\"label\":\"Ports Sort\",\"type\":10,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"asc\\\",\\\"desc\\\"]\",\"value\":\"asc\"}],\"style\":\"above\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"ADX Port Summary\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nunion isfuzzy=true (\\\\r\\\\n    EasmHostAsset\\\\r\\\\n\\\\t|where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |where array_length(Ports) > 0\\\\r\\\\n    |extend System = Host\\\\r\\\\n    |extend Source = 'EasmHostAsset'\\\\r\\\\n    |mv-expand Ports\\\\r\\\\n    |extend Port = toint(Ports.Port)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend PortLastSeen = todatetime(Ports.PortStateLastSeen)\\\\r\\\\n    |where PortLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project System, Port, LastPortState, Source,PortLastSeen\\\\r\\\\n    ),\\\\r\\\\n    (\\\\r\\\\n    EasmIpAddressAsset\\\\r\\\\n\\\\t|where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |where array_length(Ports) > 0\\\\r\\\\n    |extend System = IpAddress\\\\r\\\\n    |extend Source = 'EasmIpAddressAsset'\\\\r\\\\n    |mv-expand Ports\\\\r\\\\n    |extend Port = toint(Ports.Port)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend PortLastSeen = todatetime(Ports.PortStateLastSeen)\\\\r\\\\n    |where PortLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project System, Port, LastPortState, Source,PortLastSeen\\\\r\\\\n    )\\\\r\\\\n|extend Keep = case('{_adx_system_type}' == 'IPs Only', 'EasmIpAddressAsset', '{_adx_system_type}' == 'Hosts Only', 'EasmHostAsset', 'EasmHostAsset,EasmIpAddressAsset')\\\\r\\\\n|where Keep has Source\\\\r\\\\n|sort by System {_adx_port_sort}, Port {_adx_port_sort}\\\\r\\\\n|project-away Source,Keep\\\\r\\\\n//|summarize AllPorts = make_set(Port) by System\\\\r\\\\n//|summarize AllSystems = make_set(System) by Port\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"All Ports\",\"showRefreshButton\":true,\"exportParameterName\":\"_adx_port_to_assetlookup\",\"exportDefaultValue\":\"{\\\"System\\\":\\\"\\\",\\\"Port\\\":-1,\\\"LastPortState\\\":\\\"\\\",\\\"PortLastSeen\\\":\\\"\\\"}\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"System\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"25ch\"}}],\"rowLimit\":5000,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"35\",\"conditionalVisibilities\":[{\"parameterName\":\"_adx_port_summary\",\"comparison\":\"isNotEqualTo\",\"value\":\"By System\"},{\"parameterName\":\"_adx_port_summary\",\"comparison\":\"isNotEqualTo\",\"value\":\"By Port\"},{\"parameterName\":\"_adx_has_banner\",\"comparison\":\"isNotEqualTo\",\"value\":\"Yes\"}],\"name\":\"ADX All Ports_no groupBy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nunion isfuzzy=true (\\\\r\\\\n    EasmHostAsset\\\\r\\\\n\\\\t|where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |where array_length(Ports) > 0\\\\r\\\\n    |extend System = Host\\\\r\\\\n    |extend Source = 'EasmHostAsset'\\\\r\\\\n    |mv-expand Ports\\\\r\\\\n    |extend Port = toint(Ports.Port)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend PortLastSeen = todatetime(Ports.PortStateLastSeen)\\\\r\\\\n    |where PortLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project System, Port, LastPortState, Source,PortLastSeen\\\\r\\\\n    ),\\\\r\\\\n    (\\\\r\\\\n    EasmIpAddressAsset\\\\r\\\\n\\\\t|where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |where array_length(Ports) > 0\\\\r\\\\n    |extend System = IpAddress\\\\r\\\\n    |extend Source = 'EasmIpAddressAsset'\\\\r\\\\n    |mv-expand Ports\\\\r\\\\n    |extend Port = toint(Ports.Port)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend PortLastSeen = todatetime(Ports.PortStateLastSeen)\\\\r\\\\n    |where PortLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project System, Port, LastPortState, Source,PortLastSeen\\\\r\\\\n    )\\\\r\\\\n|extend Keep = case('{_adx_system_type}' == 'IPs Only', 'EasmIpAddressAsset', '{_adx_system_type}' == 'Hosts Only', 'EasmHostAsset', 'EasmHostAsset,EasmIpAddressAsset')\\\\r\\\\n|where Keep has Source\\\\r\\\\n|join (EasmAssetBanner\\\\r\\\\n    |where WorkspaceName == workspace\\\\r\\\\n    |where BannerLastSeen {_adx_lastseen:query}\\\\r\\\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetName,Port\\\\r\\\\n    |project-keep AssetName,Port\\\\r\\\\n) on $left.System == $right.AssetName, $left.Port == $right.Port\\\\r\\\\n|sort by System {_adx_port_sort}, Port {_adx_port_sort}\\\\r\\\\n|project-away Source,Keep,Port1,AssetName\\\\r\\\\n//|summarize AllPorts = make_set(Port) by System\\\\r\\\\n//|summarize AllSystems = make_set(System) by Port\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"All Ports\",\"showRefreshButton\":true,\"exportParameterName\":\"_adx_port_to_assetlookup\",\"exportDefaultValue\":\"{\\\"System\\\":\\\"\\\",\\\"Port\\\":-1,\\\"LastPortState\\\":\\\"\\\",\\\"PortLastSeen\\\":\\\"\\\"}\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"System\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"25ch\"}}],\"rowLimit\":5000,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"35\",\"conditionalVisibilities\":[{\"parameterName\":\"_adx_port_summary\",\"comparison\":\"isNotEqualTo\",\"value\":\"By System\"},{\"parameterName\":\"_adx_port_summary\",\"comparison\":\"isNotEqualTo\",\"value\":\"By Port\"},{\"parameterName\":\"_adx_has_banner\",\"comparison\":\"isEqualTo\",\"value\":\"Yes\"}],\"name\":\"ADX All Ports_no groupBy_hasBanner\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nunion isfuzzy=true (\\\\r\\\\n    EasmHostAsset\\\\r\\\\n\\\\t|where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |where array_length(Ports) > 0\\\\r\\\\n    |extend System = Host\\\\r\\\\n    |extend Source = 'EasmHostAsset'\\\\r\\\\n    |mv-expand Ports\\\\r\\\\n    |extend Port = toint(Ports.Port)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend PortLastSeen = todatetime(Ports.PortStateLastSeen)\\\\r\\\\n    |where PortLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project System, Port, LastPortState, Source,PortLastSeen\\\\r\\\\n    ),\\\\r\\\\n    (\\\\r\\\\n    EasmIpAddressAsset\\\\r\\\\n\\\\t|where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |where array_length(Ports) > 0\\\\r\\\\n    |extend System = IpAddress\\\\r\\\\n    |extend Source = 'EasmIpAddressAsset'\\\\r\\\\n    |mv-expand Ports\\\\r\\\\n    |extend Port = toint(Ports.Port)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend PortLastSeen = todatetime(Ports.PortStateLastSeen)\\\\r\\\\n    |where PortLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project System, Port, LastPortState, Source,PortLastSeen\\\\r\\\\n    )\\\\r\\\\n|extend Keep = case('{_adx_system_type}' == 'IPs Only', 'EasmIpAddressAsset', '{_adx_system_type}' == 'Hosts Only', 'EasmHostAsset', 'EasmHostAsset,EasmIpAddressAsset')\\\\r\\\\n|where Keep has Source\\\\r\\\\n|summarize AllPorts = make_set(Port) by System\\\\r\\\\n|extend AllPortsSorted = case('{_adx_port_sort}' == 'desc', array_sort_desc(AllPorts), array_sort_asc(AllPorts))\\\\r\\\\n|project System, AllPortsSorted\\\\r\\\\n//|summarize AllSystems = make_set(System) by Port\\\\r\\\\n|sort by System {_adx_port_sort}\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"All Ports\",\"showRefreshButton\":true,\"exportFieldName\":\"\",\"exportParameterName\":\"_adx_port_to_assetlookup\",\"exportDefaultValue\":\"{\\\"System\\\":\\\"\\\",\\\"Port\\\":-1,\\\"LastPortState\\\":\\\"\\\",\\\"PortLastSeen\\\":\\\"\\\"}\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"System\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"30ch\"}}],\"rowLimit\":1000,\"filter\":true,\"sortBy\":[{\"itemKey\":\"System\",\"sortOrder\":1}]},\"sortBy\":[{\"itemKey\":\"System\",\"sortOrder\":1}],\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"35\",\"conditionalVisibilities\":[{\"parameterName\":\"_adx_port_summary\",\"comparison\":\"isEqualTo\",\"value\":\"By System\"},{\"parameterName\":\"_adx_has_banner\",\"comparison\":\"isNotEqualTo\",\"value\":\"Yes\"}],\"name\":\"ADX All Ports_groupBy System\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nunion isfuzzy=true (\\\\r\\\\n    EasmHostAsset\\\\r\\\\n\\\\t|where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |where array_length(Ports) > 0\\\\r\\\\n    |extend System = Host\\\\r\\\\n    |extend Source = 'EasmHostAsset'\\\\r\\\\n    |mv-expand Ports\\\\r\\\\n    |extend Port = toint(Ports.Port)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend PortLastSeen = todatetime(Ports.PortStateLastSeen)\\\\r\\\\n    |where PortLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project System, Port, LastPortState, Source,PortLastSeen\\\\r\\\\n    ),\\\\r\\\\n    (\\\\r\\\\n    EasmIpAddressAsset\\\\r\\\\n\\\\t|where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |where array_length(Ports) > 0\\\\r\\\\n    |extend System = IpAddress\\\\r\\\\n    |extend Source = 'EasmIpAddressAsset'\\\\r\\\\n    |mv-expand Ports\\\\r\\\\n    |extend Port = toint(Ports.Port)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend PortLastSeen = todatetime(Ports.PortStateLastSeen)\\\\r\\\\n    |where PortLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project System, Port, LastPortState, Source,PortLastSeen\\\\r\\\\n    )\\\\r\\\\n|extend Keep = case('{_adx_system_type}' == 'IPs Only', 'EasmIpAddressAsset', '{_adx_system_type}' == 'Hosts Only', 'EasmHostAsset', 'EasmHostAsset,EasmIpAddressAsset')\\\\r\\\\n|where Keep has Source\\\\r\\\\n|join (EasmAssetBanner\\\\r\\\\n    |where WorkspaceName == workspace\\\\r\\\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId,Port,ScanType\\\\r\\\\n    |where BannerLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project-keep AssetName,Port\\\\r\\\\n) on $left.System == $right.AssetName, $left.Port == $right.Port\\\\r\\\\n|summarize AllPorts = make_set(Port) by System\\\\r\\\\n|extend AllPortsSorted = case('{_adx_port_sort}' == 'desc', array_sort_desc(AllPorts), array_sort_asc(AllPorts))\\\\r\\\\n|project System, AllPortsSorted\\\\r\\\\n//|summarize AllSystems = make_set(System) by Port\\\\r\\\\n|sort by System {_adx_port_sort}\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"All Ports\",\"showRefreshButton\":true,\"exportFieldName\":\"\",\"exportParameterName\":\"_adx_port_to_assetlookup\",\"exportDefaultValue\":\"{\\\"System\\\":\\\"\\\",\\\"Port\\\":-1,\\\"LastPortState\\\":\\\"\\\",\\\"PortLastSeen\\\":\\\"\\\"}\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"System\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"30ch\"}}],\"rowLimit\":1000,\"filter\":true,\"sortBy\":[{\"itemKey\":\"System\",\"sortOrder\":1}]},\"sortBy\":[{\"itemKey\":\"System\",\"sortOrder\":1}],\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"35\",\"conditionalVisibilities\":[{\"parameterName\":\"_adx_port_summary\",\"comparison\":\"isEqualTo\",\"value\":\"By System\"},{\"parameterName\":\"_adx_has_banner\",\"comparison\":\"isEqualTo\",\"value\":\"Yes\"}],\"name\":\"ADX All Ports_groupBy System_hasBanner\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nunion isfuzzy=true (\\\\r\\\\n    EasmHostAsset\\\\r\\\\n\\\\t|where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |where array_length(Ports) > 0\\\\r\\\\n    |extend System = Host\\\\r\\\\n    |extend Source = 'EasmHostAsset'\\\\r\\\\n    |mv-expand Ports\\\\r\\\\n    |extend Port = toint(Ports.Port)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend PortLastSeen = todatetime(Ports.PortStateLastSeen)\\\\r\\\\n    |where PortLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project System, Port, LastPortState, Source,PortLastSeen\\\\r\\\\n    ),\\\\r\\\\n    (\\\\r\\\\n    EasmIpAddressAsset\\\\r\\\\n\\\\t|where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |where array_length(Ports) > 0\\\\r\\\\n    |extend System = IpAddress\\\\r\\\\n    |extend Source = 'EasmIpAddressAsset'\\\\r\\\\n    |mv-expand Ports\\\\r\\\\n    |extend Port = toint(Ports.Port)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend PortLastSeen = todatetime(Ports.PortStateLastSeen)\\\\r\\\\n    |where PortLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project System, Port, LastPortState, Source,PortLastSeen\\\\r\\\\n    )\\\\r\\\\n|extend Keep = case('{_adx_system_type}' == 'IPs Only', 'EasmIpAddressAsset', '{_adx_system_type}' == 'Hosts Only', 'EasmHostAsset', 'EasmHostAsset,EasmIpAddressAsset')\\\\r\\\\n|where Keep has Source\\\\r\\\\n//|summarize AllPorts = make_set(Port) by System\\\\r\\\\n|summarize AllSystems = make_set(System) by Port\\\\r\\\\n|extend AllSystemsSorted = case('{_adx_port_sort}' == 'desc', array_sort_desc(AllSystems), array_sort_asc(AllSystems))\\\\r\\\\n|project Port, AllSystemsSorted\\\\r\\\\n|sort by Port {_adx_port_sort}\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"All Ports\",\"showRefreshButton\":true,\"exportFieldName\":\"\",\"exportParameterName\":\"_adx_port_to_portlookup\",\"exportDefaultValue\":\"{\\\"System\\\":\\\"\\\",\\\"Port\\\":-1,\\\"LastPortState\\\":\\\"\\\",\\\"PortLastSeen\\\":\\\"\\\"}\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":1000,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"35\",\"conditionalVisibilities\":[{\"parameterName\":\"_adx_port_summary\",\"comparison\":\"isEqualTo\",\"value\":\"By Port\"},{\"parameterName\":\"_adx_has_banner\",\"comparison\":\"isNotEqualTo\",\"value\":\"Yes\"}],\"name\":\"ADX All Ports_groupBy Port\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nunion isfuzzy=true (\\\\r\\\\n    EasmHostAsset\\\\r\\\\n\\\\t|where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |where array_length(Ports) > 0\\\\r\\\\n    |extend System = Host\\\\r\\\\n    |extend Source = 'EasmHostAsset'\\\\r\\\\n    |mv-expand Ports\\\\r\\\\n    |extend Port = toint(Ports.Port)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend PortLastSeen = todatetime(Ports.PortStateLastSeen)\\\\r\\\\n    |where PortLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project System, Port, LastPortState, Source,PortLastSeen\\\\r\\\\n    ),\\\\r\\\\n    (\\\\r\\\\n    EasmIpAddressAsset\\\\r\\\\n\\\\t|where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |where array_length(Ports) > 0\\\\r\\\\n    |extend System = IpAddress\\\\r\\\\n    |extend Source = 'EasmIpAddressAsset'\\\\r\\\\n    |mv-expand Ports\\\\r\\\\n    |extend Port = toint(Ports.Port)\\\\r\\\\n    |extend LastPortState = tostring(Ports.LastPortState)\\\\r\\\\n    |extend PortLastSeen = todatetime(Ports.PortStateLastSeen)\\\\r\\\\n    |where PortLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project System, Port, LastPortState, Source,PortLastSeen\\\\r\\\\n    )\\\\r\\\\n|extend Keep = case('{_adx_system_type}' == 'IPs Only', 'EasmIpAddressAsset', '{_adx_system_type}' == 'Hosts Only', 'EasmHostAsset', 'EasmHostAsset,EasmIpAddressAsset')\\\\r\\\\n|where Keep has Source\\\\r\\\\n|join (EasmAssetBanner\\\\r\\\\n    |where WorkspaceName == workspace\\\\r\\\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId,Port,ScanType\\\\r\\\\n    |where BannerLastSeen {_adx_lastseen:query}\\\\r\\\\n    |project-keep AssetName,Port\\\\r\\\\n) on $left.System == $right.AssetName, $left.Port == $right.Port\\\\r\\\\n//|summarize AllPorts = make_set(Port) by System\\\\r\\\\n|summarize AllSystems = make_set(System) by Port\\\\r\\\\n|extend AllSystemsSorted = case('{_adx_port_sort}' == 'desc', array_sort_desc(AllSystems), array_sort_asc(AllSystems))\\\\r\\\\n|project Port, AllSystemsSorted\\\\r\\\\n|sort by Port {_adx_port_sort}\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"All Ports\",\"showRefreshButton\":true,\"exportFieldName\":\"\",\"exportParameterName\":\"_adx_port_to_portlookup\",\"exportDefaultValue\":\"{\\\"System\\\":\\\"\\\",\\\"Port\\\":-1,\\\"LastPortState\\\":\\\"\\\",\\\"PortLastSeen\\\":\\\"\\\"}\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":1000,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"35\",\"conditionalVisibilities\":[{\"parameterName\":\"_adx_port_summary\",\"comparison\":\"isEqualTo\",\"value\":\"By Port\"},{\"parameterName\":\"_adx_has_banner\",\"comparison\":\"isEqualTo\",\"value\":\"Yes\"}],\"name\":\"ADX All Ports_groupBy Port_hasBanner\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nlet asset_name = tostring(parse_json('{_adx_port_to_assetlookup}').System);\\\\r\\\\nEasmAssetBanner\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|where AssetName == asset_name\\\\r\\\\n|where BannerLastSeen {_adx_lastseen:query}\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by Port,ScanType,AssetName\\\\r\\\\n|project-keep AssetName, Port, ScanType, Banner*\\\\r\\\\n|project-reorder AssetName,Port,ScanType,Banner\\\\r\\\\n|sort by Port {_adx_port_sort}\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"Asset Banners\",\"noDataMessage\":\"No Banner information found. Select a (different) row from All Ports\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":500,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"65\",\"conditionalVisibility\":{\"parameterName\":\"_adx_port_to_portlookup\",\"comparison\":\"isEqualTo\"},\"name\":\"ADX Asset Banners by System\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nlet port_num = replace_regex('{_adx_port_to_portlookup}', @'.+Port\\\\\\\":(\\\\\\\\d+).+', @'\\\\\\\\1');\\\\r\\\\nEasmAssetBanner\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|where Port == port_num\\\\r\\\\n|where BannerLastSeen {_adx_lastseen:query}\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetName,ScanType,Port\\\\r\\\\n|project-keep AssetName, Port, ScanType, Banner*\\\\r\\\\n|project-reorder AssetName,Port,ScanType,Banner\\\\r\\\\n|sort by AssetName {_adx_port_sort}\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"Asset Banners\",\"noDataMessage\":\"No Banner information found. Select a (different) row from All Ports\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":500,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"65\",\"conditionalVisibility\":{\"parameterName\":\"_adx_port_to_assetlookup\",\"comparison\":\"isEqualTo\"},\"name\":\"ADX Asset Banners by Port\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"df71056a-a50d-423b-82ab-204948cebc96\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_wc_sort\",\"label\":\"Sort Web Component\",\"type\":10,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"asc\\\",\\\"desc\\\"]\",\"timeContext\":{\"durationMs\":86400000},\"value\":\"desc\"}],\"style\":\"above\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"ADX Web Components\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmAssetWebComponent\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n|where AssetLastSeen {_adx_lastseen:query} and WebComponentLastSeen {_adx_lastseen:query}\\\\r\\\\n|extend Name = WebComponentName, Version = WebComponentVersion\\\\r\\\\n|project-keep Name,Version,SnapshotDateTime,AssetName\\\\r\\\\n|summarize Count=count() by Name,Version\\\\r\\\\n|sort by Count {_adx_wc_sort}\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"Web Components\",\"showRefreshButton\":true,\"exportParameterName\":\"_adx_wc_detail\",\"exportDefaultValue\":\"{\\\"Name\\\":\\\"\\\",\\\"Version\\\":\\\"\\\",\\\"Category\\\":\\\"\\\"}\",\"showExportToExcel\":true,\"queryType\":9,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"$gen_group\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"30ch\"}},{\"columnMatch\":\"Group\",\"formatter\":1,\"formatOptions\":{\"customColumnWidthSetting\":\"30ch\"}},{\"columnMatch\":\"Name\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"25ch\"}},{\"columnMatch\":\"Version\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"12ch\"}},{\"columnMatch\":\"Count\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"11ch\"}},{\"columnMatch\":\"$gen_group\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"30ch\"}}],\"rowLimit\":5000,\"filter\":true,\"hierarchySettings\":{\"treeType\":1,\"groupBy\":[\"Name\"],\"expandTopLevel\":true}}},\"customWidth\":\"40\",\"name\":\"ADX Web Components\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nlet Name = tostring(parse_json('{_adx_wc_detail}').Name);\\\\r\\\\nlet Version = tostring(parse_json('{_adx_wc_detail}').Version);\\\\r\\\\nEasmAssetWebComponent\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n|where AssetLastSeen {_adx_lastseen:query} and WebComponentLastSeen {_adx_lastseen:query}\\\\r\\\\n|where WebComponentName == Name and WebComponentVersion == Version\\\\r\\\\n|extend Category = WebComponentCategory, Name, Version\\\\r\\\\n|project-keep AssetName,Name,Version,Category,AssetLastSeen\\\\r\\\\n|project-reorder AssetName,Name,Version,Category,AssetLastSeen\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"Investigate WebComponent\",\"noDataMessage\":\"Select a Web Component to find associated assets\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"gridSettings\":{\"rowLimit\":2000,\"filter\":true}},\"customWidth\":\"60\",\"name\":\"ADX WebComponent to Asset\",\"styleSettings\":{\"showBorder\":true}}]},\"conditionalVisibilities\":[{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Risk Findings\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX CVEs\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Host Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX IP Address Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Page Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX SSL Certificate Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Domain Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Web Components\"}],\"name\":\"ADX Workspace Summary\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"Workspace Summary\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n|summarize Count=count() by AssetType_s\\r\\n|sort by Count desc\",\"size\":4,\"showAnalytics\":true,\"title\":\"Asset Types\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"AssetType_s\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":true,\"size\":\"auto\"}},\"customWidth\":\"87\",\"name\":\"LA Asset Types\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n|extend TotalCount = 'Total'\\r\\n|summarize Total=count() by TotalCount\",\"size\":4,\"showAnalytics\":true,\"title\":\"Asset Count\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"TotalCount\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Total\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"useGrouping\":false,\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":true,\"sortCriteriaField\":\"Total\",\"sortOrderField\":2,\"size\":\"auto\"}},\"customWidth\":\"13\",\"name\":\"LA Asset Count\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|summarize Count=count() by AssetType_s,SnapshotDateTime_t\",\"size\":0,\"aggregation\":5,\"showAnnotations\":true,\"showAnalytics\":true,\"title\":\"Asset Types Over Time\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"timechart\",\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AssetType\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}}},\"customWidth\":\"60\",\"name\":\"LA Asset Types Over Time\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmIpAddressAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n|where isnotempty(Locations_s)\\r\\n|union kind=inner (EasmHostAsset_CL\\r\\n    |where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n    |where isnotempty(Locations_s))\\r\\n|extend Locations_j = parse_json(Locations_s)\\r\\n|project-keep Locations_j,AssetName_s\\r\\n|mv-expand Locations_j\\r\\n|extend Region = tostring(Locations_j.Region), City = tostring(Locations_j.City), Latitude = toreal(Locations_j.Latitude), Longitude = toreal(Locations_j.Longitude)\\r\\n|where isnotempty(Latitude) and isnotempty(Longitude) and isnotempty(Region) and isnotempty(City)\\r\\n|summarize Count=count() by Latitude,Longitude,Region,City\",\"size\":0,\"showAnalytics\":true,\"title\":\"Asset Locations\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"map\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"Region\",\"formatter\":1},\"subtitleContent\":{\"columnMatch\":\"City\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"}},\"showBorder\":false,\"sortCriteriaField\":\"Count\",\"sortOrderField\":2,\"size\":\"auto\"},\"mapSettings\":{\"locInfo\":\"LatLong\",\"locInfoColumn\":\"Region\",\"latitude\":\"Latitude\",\"longitude\":\"Longitude\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Max\",\"opacity\":0.7,\"labelSettings\":\"City\",\"legendMetric\":\"Count\",\"numberOfMetrics\":20,\"legendAggregation\":\"Max\",\"itemColorSettings\":{\"nodeColorField\":\"Count\",\"colorAggregation\":\"Max\",\"type\":\"heatmap\",\"heatmapPalette\":\"categorical\"}}},\"customWidth\":\"40\",\"name\":\"LA Asset Locations\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"92020e51-938f-4494-91af-80caea4acaff\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_port_summary\",\"label\":\"Ports Summary\",\"type\":10,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"By System\\\",\\\"By Port\\\"]\",\"timeContext\":{\"durationMs\":86400000}},{\"id\":\"caf51a2e-92ce-4823-bec8-3b9166b5ea05\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_system_type\",\"label\":\"Ports System Types\",\"type\":10,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"All\\\",\\\"IPs Only\\\",\\\"Hosts Only\\\"]\",\"value\":\"All\"},{\"id\":\"d27e6b5c-43cc-434f-9bf8-0eb1035be4d2\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_has_banner\",\"label\":\"Has Banner?\",\"type\":10,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"Yes\\\"]\"},{\"id\":\"1dc9af90-127b-43cb-a525-ee806e11ae8f\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_port_sort\",\"label\":\"Ports Sort\",\"type\":10,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"asc\\\",\\\"desc\\\"]\",\"value\":\"asc\"}],\"style\":\"above\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"LA Port Summary\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nunion isfuzzy=true (\\r\\n    EasmHostAsset_CL\\r\\n\\t|where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(Ports_s)\\r\\n    |extend Ports_j = parse_json(Ports_s)\\r\\n    |extend System = AssetName_s\\r\\n    |extend Source = 'EasmHostAsset_CL'\\r\\n    |mv-expand Ports_j\\r\\n    |extend Port = todouble(Ports_j.Port), LastPortState = tostring(Ports_j.LastPortState), PortLastSeen = todatetime(Ports_j.PortStateLastSeen)\\r\\n    |where PortLastSeen {_la_lastseen:query}\\r\\n    |project System, Port, LastPortState, Source, PortLastSeen\\r\\n    ),\\r\\n    (\\r\\n    EasmIpAddressAsset_CL\\r\\n\\t|where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(Ports_s)\\r\\n    |extend Ports_j = parse_json(Ports_s)\\r\\n    |extend System = AssetName_s\\r\\n    |extend Source = 'EasmIpAddressAsset_CL'\\r\\n    |mv-expand Ports_j\\r\\n    |extend Port = todouble(Ports_j.Port), LastPortState = tostring(Ports_j.LastPortState), PortLastSeen = todatetime(Ports_j.PortStateLastSeen)\\r\\n    |where PortLastSeen {_la_lastseen:query}\\r\\n    |project System, Port, LastPortState, Source, PortLastSeen\\r\\n    )\\r\\n|extend Keep = case('{_la_system_type}' == 'IPs Only', 'EasmIpAddressAsset_CL', '{_la_system_type}' == 'Hosts Only', 'EasmHostAsset_CL', 'EasmHostAsset_CL,EasmIpAddressAsset_CL')\\r\\n|where Keep has Source\\r\\n|sort by System {_la_port_sort}, Port {_la_port_sort}\\r\\n|project-away Source,Keep\\r\\n//|summarize AllPorts = make_set(Port) by System\\r\\n//|summarize AllSystems = make_set(System) by Port\",\"size\":0,\"showAnalytics\":true,\"title\":\"All Ports\",\"showRefreshButton\":true,\"exportParameterName\":\"_la_port_to_assetlookup\",\"exportDefaultValue\":\"{\\\"System\\\":\\\"\\\",\\\"Port\\\":-1,\\\"LastPortState\\\":\\\"\\\",\\\"PortLastSeen\\\":\\\"\\\"}\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"System\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"25ch\"}}],\"rowLimit\":5000,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"35\",\"conditionalVisibilities\":[{\"parameterName\":\"_la_port_summary\",\"comparison\":\"isNotEqualTo\",\"value\":\"By System\"},{\"parameterName\":\"_la_port_summary\",\"comparison\":\"isNotEqualTo\",\"value\":\"By Port\"},{\"parameterName\":\"_la_has_banner\",\"comparison\":\"isNotEqualTo\",\"value\":\"Yes\"}],\"name\":\"LA All Ports_no groupBy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nunion isfuzzy=true (\\r\\n    EasmHostAsset_CL\\r\\n\\t|where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(Ports_s)\\r\\n    |extend Ports_j = parse_json(Ports_s)\\r\\n    |extend System = AssetName_s\\r\\n    |extend Source = 'EasmHostAsset_CL'\\r\\n    |mv-expand Ports_j\\r\\n    |extend Port = todouble(Ports_j.Port), LastPortState = tostring(Ports_j.LastPortState), PortLastSeen = todatetime(Ports_j.PortStateLastSeen)\\r\\n    |where PortLastSeen {_la_lastseen:query}\\r\\n    |project System, Port, LastPortState, Source, PortLastSeen\\r\\n    ),\\r\\n    (\\r\\n    EasmIpAddressAsset_CL\\r\\n\\t|where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(Ports_s)\\r\\n    |extend Ports_j = parse_json(Ports_s)\\r\\n    |extend System = AssetName_s\\r\\n    |extend Source = 'EasmIpAddressAsset_CL'\\r\\n    |mv-expand Ports_j\\r\\n    |extend Port = todouble(Ports_j.Port), LastPortState = tostring(Ports_j.LastPortState), PortLastSeen = todatetime(Ports_j.PortStateLastSeen)\\r\\n    |where PortLastSeen {_la_lastseen:query}\\r\\n    |project System, Port, LastPortState, Source, PortLastSeen\\r\\n    )\\r\\n|extend Keep = case('{_la_system_type}' == 'IPs Only', 'EasmIpAddressAsset_CL', '{_la_system_type}' == 'Hosts Only', 'EasmHostAsset_CL', 'EasmHostAsset_CL,EasmIpAddressAsset_CL')\\r\\n|where Keep has Source\\r\\n|join (EasmAssetBanner_CL\\r\\n    |where WorkspaceName_s == workspace\\r\\n    |where BannerLastSeen_t {_la_lastseen:query}\\r\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetName_s,Port_d\\r\\n    |project-keep AssetName_s,Port_d\\r\\n) on $left.System == $right.AssetName_s, $left.Port == $right.Port_d\\r\\n|sort by System {_la_port_sort}, Port {_la_port_sort}\\r\\n|project-away Source,Keep,AssetName_s,Port_d\\r\\n//|summarize AllPorts = make_set(Port) by System\\r\\n//|summarize AllSystems = make_set(System) by Port\",\"size\":0,\"showAnalytics\":true,\"title\":\"All Ports\",\"showRefreshButton\":true,\"exportParameterName\":\"_la_port_to_assetlookup\",\"exportDefaultValue\":\"{\\\"System\\\":\\\"\\\",\\\"Port\\\":-1,\\\"LastPortState\\\":\\\"\\\",\\\"PortLastSeen\\\":\\\"\\\"}\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"System\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"25ch\"}}],\"rowLimit\":5000,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"35\",\"conditionalVisibilities\":[{\"parameterName\":\"_la_port_summary\",\"comparison\":\"isNotEqualTo\",\"value\":\"By System\"},{\"parameterName\":\"_la_port_summary\",\"comparison\":\"isNotEqualTo\",\"value\":\"By Port\"},{\"parameterName\":\"_la_has_banner\",\"comparison\":\"isEqualTo\",\"value\":\"Yes\"}],\"name\":\"LA All Ports_no groupBy_hasBanner\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nunion isfuzzy=true (\\r\\n    EasmHostAsset_CL\\r\\n\\t|where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(Ports_s)\\r\\n    |extend Ports_j = parse_json(Ports_s)\\r\\n    |extend System = AssetName_s\\r\\n    |extend Source = 'EasmHostAsset_CL'\\r\\n    |mv-expand Ports_j\\r\\n    |extend Port = toint(Ports_j.Port), LastPortState = tostring(Ports_j.LastPortState), PortLastSeen = todatetime(Ports_j.PortStateLastSeen)\\r\\n    |where PortLastSeen {_la_lastseen:query}\\r\\n    |project System, Port, LastPortState, Source\\r\\n    ),\\r\\n    (\\r\\n    EasmIpAddressAsset_CL\\r\\n\\t|where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(Ports_s)\\r\\n    |extend Ports_j = parse_json(Ports_s)\\r\\n    |extend System = AssetName_s\\r\\n    |extend Source = 'EasmIpAddressAsset_CL'\\r\\n    |mv-expand Ports_j\\r\\n    |extend Port = toint(Ports_j.Port), LastPortState = tostring(Ports_j.LastPortState), PortLastSeen = todatetime(Ports_j.PortStateLastSeen)\\r\\n    |where PortLastSeen {_la_lastseen:query}\\r\\n    |project System, Port, LastPortState, Source\\r\\n    )\\r\\n|extend Keep = case('{_la_system_type}' == 'IPs Only', 'EasmIpAddressAsset_CL', '{_la_system_type}' == 'Hosts Only', 'EasmHostAsset_CL', 'EasmHostAsset_CL,EasmIpAddressAsset_CL')\\r\\n|where Keep has Source\\r\\n|summarize AllPorts = make_set(Port) by System\\r\\n|extend AllPortsSorted = case('{_la_port_sort}' == 'desc', array_sort_desc(AllPorts), array_sort_asc(AllPorts))\\r\\n|project System, AllPortsSorted\\r\\n//|summarize AllSystems = make_set(System) by Port\\r\\n|sort by System {_la_port_sort}\",\"size\":0,\"showAnalytics\":true,\"title\":\"All Ports\",\"showRefreshButton\":true,\"exportParameterName\":\"_la_port_to_assetlookup\",\"exportDefaultValue\":\"{\\\"System\\\":\\\"\\\",\\\"Port\\\":-1,\\\"LastPortState\\\":\\\"\\\",\\\"PortLastSeen\\\":\\\"\\\"}\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"System\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"30ch\"}}],\"rowLimit\":5000,\"filter\":true},\"sortBy\":[],\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"35\",\"conditionalVisibilities\":[{\"parameterName\":\"_la_port_summary\",\"comparison\":\"isEqualTo\",\"value\":\"By System\"},{\"parameterName\":\"_la_has_banner\",\"comparison\":\"isNotEqualTo\",\"value\":\"Yes\"}],\"name\":\"LA All Ports_groupBy System\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nunion isfuzzy=true (\\r\\n    EasmHostAsset_CL\\r\\n\\t|where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(Ports_s)\\r\\n    |extend Ports_j = parse_json(Ports_s)\\r\\n    |extend System = AssetName_s\\r\\n    |extend Source = 'EasmHostAsset_CL'\\r\\n    |mv-expand Ports_j\\r\\n    |extend Port = todouble(Ports_j.Port), LastPortState = tostring(Ports_j.LastPortState), PortLastSeen = todatetime(Ports_j.PortStateLastSeen)\\r\\n    |where PortLastSeen {_la_lastseen:query}\\r\\n    |project System, Port, LastPortState, Source\\r\\n    ),\\r\\n    (\\r\\n    EasmIpAddressAsset_CL\\r\\n\\t|where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(Ports_s)\\r\\n    |extend Ports_j = parse_json(Ports_s)\\r\\n    |extend System = AssetName_s\\r\\n    |extend Source = 'EasmIpAddressAsset_CL'\\r\\n    |mv-expand Ports_j\\r\\n    |extend Port = todouble(Ports_j.Port), LastPortState = tostring(Ports_j.LastPortState), PortLastSeen = todatetime(Ports_j.PortStateLastSeen)\\r\\n    |where PortLastSeen {_la_lastseen:query}\\r\\n    |project System, Port, LastPortState, Source\\r\\n    )\\r\\n|extend Keep = case('{_la_system_type}' == 'IPs Only', 'EasmIpAddressAsset_CL', '{_la_system_type}' == 'Hosts Only', 'EasmHostAsset_CL', 'EasmHostAsset_CL,EasmIpAddressAsset_CL')\\r\\n|where Keep has Source\\r\\n|join (EasmAssetBanner_CL\\r\\n    |where WorkspaceName_s == workspace\\r\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s,Port_d,ScanType_s\\r\\n    |where BannerLastSeen_t {_la_lastseen:query}\\r\\n    |project-keep AssetName_s,Port_d\\r\\n) on $left.System == $right.AssetName_s, $left.Port == $right.Port_d\\r\\n|summarize AllPorts = make_set(Port) by System\\r\\n|extend AllPortsSorted = case('{_la_port_sort}' == 'desc', array_sort_desc(AllPorts), array_sort_asc(AllPorts))\\r\\n|project System, AllPortsSorted\\r\\n//|summarize AllSystems = make_set(System) by Port\\r\\n|sort by System {_la_port_sort}\",\"size\":0,\"showAnalytics\":true,\"title\":\"All Ports\",\"showRefreshButton\":true,\"exportParameterName\":\"_la_port_to_assetlookup\",\"exportDefaultValue\":\"{\\\"System\\\":\\\"\\\",\\\"Port\\\":-1,\\\"LastPortState\\\":\\\"\\\",\\\"PortLastSeen\\\":\\\"\\\"}\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"System\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"30ch\"}}],\"rowLimit\":5000,\"filter\":true},\"sortBy\":[],\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"35\",\"conditionalVisibilities\":[{\"parameterName\":\"_la_port_summary\",\"comparison\":\"isEqualTo\",\"value\":\"By System\"},{\"parameterName\":\"_la_has_banner\",\"comparison\":\"isEqualTo\",\"value\":\"Yes\"}],\"name\":\"LA All Ports_groupBy System_hasBanner\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nunion isfuzzy=true (\\r\\n    EasmHostAsset_CL\\r\\n\\t|where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(Ports_s)\\r\\n    |extend Ports_j = parse_json(Ports_s)\\r\\n    |extend System = AssetName_s\\r\\n    |extend Source = 'EasmHostAsset_CL'\\r\\n    |mv-expand Ports_j\\r\\n    |extend Port = toint(Ports_j.Port), LastPortState = tostring(Ports_j.LastPortState), PortLastSeen = todatetime(Ports_j.PortStateLastSeen)\\r\\n    |where PortLastSeen {_la_lastseen:query}\\r\\n    |project System, Port, LastPortState, Source\\r\\n    ),\\r\\n    (\\r\\n    EasmIpAddressAsset_CL\\r\\n\\t|where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(Ports_s)\\r\\n    |extend Ports_j = parse_json(Ports_s)\\r\\n    |extend System = AssetName_s\\r\\n    |extend Source = 'EasmIpAddressAsset_CL'\\r\\n    |mv-expand Ports_j\\r\\n    |extend Port = toint(Ports_j.Port), LastPortState = tostring(Ports_j.LastPortState), PortLastSeen = todatetime(Ports_j.PortStateLastSeen)\\r\\n    |where PortLastSeen {_la_lastseen:query}\\r\\n    |project System, Port, LastPortState, Source\\r\\n    )\\r\\n|extend Keep = case('{_la_system_type}' == 'IPs Only', 'EasmIpAddressAsset_CL', '{_la_system_type}' == 'Hosts Only', 'EasmHostAsset_CL', 'EasmHostAsset_CL,EasmIpAddressAsset_CL')\\r\\n|where Keep has Source\\r\\n//|summarize AllPorts = make_set(Port) by System\\r\\n|summarize AllSystems = make_set(System) by Port\\r\\n|extend AllSystemsSorted = case('{_la_port_sort}' == 'desc', array_sort_desc(AllSystems),array_sort_asc(AllSystems))\\r\\n|project Port, AllSystemsSorted\\r\\n|sort by Port {_la_port_sort}\",\"size\":0,\"showAnalytics\":true,\"title\":\"All Ports\",\"showRefreshButton\":true,\"exportParameterName\":\"_la_port_to_portlookup\",\"exportDefaultValue\":\"{\\\"Port\\\":-1,\\\"AllSystems\\\":[]}\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":5000,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"35\",\"conditionalVisibilities\":[{\"parameterName\":\"_la_port_summary\",\"comparison\":\"isEqualTo\",\"value\":\"By Port\"},{\"parameterName\":\"_la_has_banner\",\"comparison\":\"isNotEqualTo\",\"value\":\"Yes\"}],\"name\":\"LA All Ports_groupBy Port\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nunion isfuzzy=true (\\r\\n    EasmHostAsset_CL\\r\\n\\t|where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(Ports_s)\\r\\n    |extend Ports_j = parse_json(Ports_s)\\r\\n    |extend System = AssetName_s\\r\\n    |extend Source = 'EasmHostAsset_CL'\\r\\n    |mv-expand Ports_j\\r\\n    |extend Port = todouble(Ports_j.Port), LastPortState = tostring(Ports_j.LastPortState), PortLastSeen = todatetime(Ports_j.PortStateLastSeen)\\r\\n    |where PortLastSeen {_la_lastseen:query}\\r\\n    |project System, Port, LastPortState, Source\\r\\n    ),\\r\\n    (\\r\\n    EasmIpAddressAsset_CL\\r\\n\\t|where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(Ports_s)\\r\\n    |extend Ports_j = parse_json(Ports_s)\\r\\n    |extend System = AssetName_s\\r\\n    |extend Source = 'EasmIpAddressAsset_CL'\\r\\n    |mv-expand Ports_j\\r\\n    |extend Port = todouble(Ports_j.Port), LastPortState = tostring(Ports_j.LastPortState), PortLastSeen = todatetime(Ports_j.PortStateLastSeen)\\r\\n    |where PortLastSeen {_la_lastseen:query}\\r\\n    |project System, Port, LastPortState, Source\\r\\n    )\\r\\n|extend Keep = case('{_la_system_type}' == 'IPs Only', 'EasmIpAddressAsset_CL', '{_la_system_type}' == 'Hosts Only', 'EasmHostAsset_CL', 'EasmHostAsset_CL,EasmIpAddressAsset_CL')\\r\\n|where Keep has Source\\r\\n|join (EasmAssetBanner_CL\\r\\n    |where WorkspaceName_s == workspace\\r\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s,Port_d,ScanType_s\\r\\n    |where BannerLastSeen_t {_la_lastseen:query}\\r\\n    |project-keep AssetName_s,Port_d\\r\\n) on $left.System == $right.AssetName_s, $left.Port == $right.Port_d\\r\\n//|summarize AllPorts = make_set(Port) by System\\r\\n|summarize AllSystems = make_set(System) by Port\\r\\n|extend AllSystemsSorted = case('{_la_port_sort}' == 'desc', array_sort_desc(AllSystems),array_sort_asc(AllSystems))\\r\\n|project Port, AllSystemsSorted\\r\\n|sort by Port {_la_port_sort}\",\"size\":0,\"showAnalytics\":true,\"title\":\"All Ports\",\"showRefreshButton\":true,\"exportParameterName\":\"_la_port_to_portlookup\",\"exportDefaultValue\":\"{\\\"Port\\\":-1,\\\"AllSystems\\\":[]}\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":5000,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"35\",\"conditionalVisibilities\":[{\"parameterName\":\"_la_port_summary\",\"comparison\":\"isEqualTo\",\"value\":\"By Port\"},{\"parameterName\":\"_la_has_banner\",\"comparison\":\"isEqualTo\",\"value\":\"Yes\"}],\"name\":\"LA All Ports_groupBy Port_hasBanner\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nlet asset_name = tostring(parse_json('{_la_port_to_assetlookup}').System);\\r\\nEasmAssetBanner_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|where AssetName_s == asset_name\\r\\n|where BannerLastSeen_t {_la_lastseen:query}\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by Port_d,ScanType_s\\r\\n|project-keep AssetName_s, Port_d, ScanType_s, Banner*\\r\\n|project-reorder AssetName_s,Port_d,ScanType_s,Banner_s\\r\\n|sort by Port_d {_la_port_sort}\",\"size\":0,\"showAnalytics\":true,\"title\":\"Asset Banners\",\"noDataMessage\":\"No Banner information found. Select a (different) row from All Ports\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":5000,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"65\",\"conditionalVisibility\":{\"parameterName\":\"_la_port_to_portlookup\",\"comparison\":\"isEqualTo\"},\"name\":\"LA Asset Banners by System\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nlet port_num = replace_regex('{_la_port_to_portlookup}', @'.+Port\\\":(\\\\d+).+', @'\\\\1');\\r\\nEasmAssetBanner_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|where Port_d == port_num\\r\\n|where BannerLastSeen_t {_la_lastseen:query}\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetName_s,ScanType_s\\r\\n|project-keep AssetName_s, Port_d, ScanType_s, Banner*\\r\\n|project-reorder AssetName_s,Port_d,ScanType_s,Banner_s\\r\\n|sort by AssetName_s {_la_port_sort}\",\"size\":0,\"showAnalytics\":true,\"title\":\"Asset Banners\",\"noDataMessage\":\"No Banner information found. Select a (different) row from All Ports\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":5000,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"System\"},\"leftContent\":{\"columnMatch\":\"AllPorts\"},\"showBorder\":false},\"graphSettings\":{\"type\":0}},\"customWidth\":\"65\",\"conditionalVisibility\":{\"parameterName\":\"_la_port_to_assetlookup\",\"comparison\":\"isEqualTo\"},\"name\":\"LA Asset Banners by Port\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"df71056a-a50d-423b-82ab-204948cebc96\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_wc_sort\",\"label\":\"Sort Web Component\",\"type\":10,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"asc\\\",\\\"desc\\\"]\",\"timeContext\":{\"durationMs\":86400000},\"value\":\"desc\"}],\"style\":\"above\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"LA Web Components\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmAssetWebComponent_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n|where AssetLastSeen_t {_la_lastseen:query} and WebComponentLastSeen_t {_la_lastseen:query}\\r\\n|extend Name = WebComponentName_s, Version = WebComponentVersion_s\\r\\n|project-keep Name,Version\\r\\n|summarize Count=count() by Name,Version\\r\\n|sort by Count {_la_wc_sort}\",\"size\":0,\"showAnalytics\":true,\"title\":\"Web Components\",\"showRefreshButton\":true,\"exportParameterName\":\"_la_wc_detail\",\"exportDefaultValue\":\"{\\\"Name\\\":\\\"\\\",\\\"Version\\\":\\\"\\\",\\\"Category\\\":\\\"\\\"}\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"$gen_group\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"30ch\"}},{\"columnMatch\":\"Group\",\"formatter\":1,\"formatOptions\":{\"customColumnWidthSetting\":\"30ch\"}},{\"columnMatch\":\"Name\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"25ch\"}},{\"columnMatch\":\"Version\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"12ch\"}},{\"columnMatch\":\"Count\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"11ch\"}},{\"columnMatch\":\"$gen_group\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"30ch\"}}],\"rowLimit\":5000,\"filter\":true,\"hierarchySettings\":{\"treeType\":1,\"groupBy\":[\"Name\"],\"expandTopLevel\":true}}},\"customWidth\":\"40\",\"name\":\"LA Web Components\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nlet Name = tostring(parse_json('{_la_wc_detail}').Name);\\r\\nlet Version = tostring(parse_json('{_la_wc_detail}').Version);\\r\\nEasmAssetWebComponent_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n|where AssetLastSeen_t {_la_lastseen:query} and WebComponentLastSeen_t {_la_lastseen:query}\\r\\n|where WebComponentName_s == Name and WebComponentVersion_s == Version\\r\\n|extend Category = WebComponentCategory_s, Name, Version\\r\\n|project-keep AssetName_s,Name,Version,Category,AssetLastSeen_t\\r\\n|project-reorder AssetName_s,Name,Version,Category,AssetLastSeen_t\",\"size\":0,\"showAnalytics\":true,\"title\":\"Investigate WebComponent\",\"noDataMessage\":\"Select a Web Component to find associated assets\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"gridSettings\":{\"rowLimit\":2000,\"filter\":true}},\"customWidth\":\"60\",\"name\":\"LA WebComponent to Asset\",\"styleSettings\":{\"showBorder\":true}}]},\"conditionalVisibilities\":[{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Risk Findings\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA CVEs\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Host Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA IP Address Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Page Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA SSL Certificate Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Domain Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Web Components\"}],\"name\":\"LA Workspace Summary\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"Risk Findings\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmRisk\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n|where CategoryName startswith_cs 'High'\\\\r\\\\n|extend Priority = 'High'\\\\r\\\\n|project-keep Priority,MetricDisplayName,SnapshotDateTime,AssetName\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by Priority,MetricDisplayName,AssetName\\\\r\\\\n|summarize Count=count() by Priority,MetricDisplayName\\\\r\\\\n|order by Count desc \\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\"High Risk Findings\",\"showRefreshButton\":true,\"exportFieldName\":\"MetricDisplayName\",\"exportParameterName\":\"_adx_risk_finding_high\",\"exportDefaultValue\":\"xyz\",\"showExportToExcel\":true,\"queryType\":9,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Priority\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"12ch\"}},{\"columnMatch\":\"MetricDisplayName\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"53ch\"}},{\"columnMatch\":\"Count\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"11ch\"}}],\"filter\":true},\"sortBy\":[]},\"customWidth\":\"33\",\"name\":\"ADX High Risk Findings\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmRisk\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n|where CategoryName startswith_cs 'Medium'\\\\r\\\\n|extend Priority = 'Medium'\\\\r\\\\n|project-keep Priority,MetricDisplayName,SnapshotDateTime,AssetName\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by Priority,MetricDisplayName,AssetName\\\\r\\\\n|summarize Count=count() by Priority,MetricDisplayName\\\\r\\\\n|sort by Count desc \\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\"Medium Risk Findings\",\"showRefreshButton\":true,\"exportFieldName\":\"MetricDisplayName\",\"exportParameterName\":\"_adx_risk_finding_med\",\"exportDefaultValue\":\"xyz\",\"showExportToExcel\":true,\"queryType\":9,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Priority\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"12ch\"}},{\"columnMatch\":\"MetricDisplayName\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"53ch\"}},{\"columnMatch\":\"Count\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"11ch\"}}],\"filter\":true,\"sortBy\":[{\"itemKey\":\"Count\",\"sortOrder\":2}]},\"sortBy\":[{\"itemKey\":\"Count\",\"sortOrder\":2}]},\"customWidth\":\"33\",\"name\":\"ADX Medium Risk Findings\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmRisk\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n|where CategoryName startswith_cs 'Low'\\\\r\\\\n|extend Priority = 'Low'\\\\r\\\\n|project-keep Priority,MetricDisplayName,SnapshotDateTime,AssetName\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by Priority,MetricDisplayName,AssetName\\\\r\\\\n|summarize Count=count() by Priority,MetricDisplayName\\\\r\\\\n|order by Count desc \\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\"Low Risk Findings\",\"showRefreshButton\":true,\"exportFieldName\":\"MetricDisplayName\",\"exportParameterName\":\"_adx_risk_finding_low\",\"exportDefaultValue\":\"xyz\",\"showExportToExcel\":true,\"queryType\":9,\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Priority\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"12ch\"}},{\"columnMatch\":\"MetricDisplayName\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"53ch\"}},{\"columnMatch\":\"Count\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"11ch\"}}],\"filter\":true}},\"customWidth\":\"33\",\"name\":\"ADX Low Risk Findings\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nlet metric_name_high = '{_adx_risk_finding_high}';\\\\r\\\\nlet metric_name_med = '{_adx_risk_finding_med}';\\\\r\\\\nlet metric_name_low = '{_adx_risk_finding_low}';\\\\r\\\\nEasmRisk\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n|where MetricDisplayName in (metric_name_high,metric_name_med,metric_name_low)\\\\r\\\\n|extend Priority =  case(CategoryName startswith_cs 'High','High',CategoryName startswith_cs 'Medium','Medium','Low')\\\\r\\\\n|extend PrioNum = case(Priority == 'High',1,Priority == 'Medium',2,3)\\\\r\\\\n|project-keep AssetName,MetricDisplayName,AssetLastSeen,AssetDescription,Priority,PrioNum\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(AssetLastSeen, *) by AssetName,MetricDisplayName,AssetDescription,Priority,PrioNum\\\\r\\\\n|project-reorder Priority,AssetName\\\\r\\\\n|sort by PrioNum asc\\\\r\\\\n|project-away PrioNum\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\"Risk Details\",\"noDataMessage\":\"No risk findings found. Select a risk finding above\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"gridSettings\":{\"filter\":true}},\"name\":\"ADX Risk Details\",\"styleSettings\":{\"showBorder\":true}}]},\"conditionalVisibilities\":[{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Workspace Summary\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX CVEs\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Host Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX IP Address Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Page Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX SSL Certificate Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Domain Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Web Components\"}],\"name\":\"ADX Risk Findings\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"Risk Findings\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmRisk_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where AssetLastSeen_t {_la_lastseen:query}\\r\\n|where CategoryName_s startswith_cs 'High'\\r\\n|extend Priority = 'High'\\r\\n|project-keep Priority,MetricDisplayName_s,SnapshotDateTime_t,AssetName_s\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by Priority,MetricDisplayName_s,AssetName_s\\r\\n|summarize Count=count() by Priority,MetricDisplayName_s\\r\\n|order by Count desc \",\"size\":1,\"showAnalytics\":true,\"title\":\"High Risk Findings\",\"showRefreshButton\":true,\"exportFieldName\":\"MetricDisplayName_s\",\"exportParameterName\":\"_la_risk_finding_high\",\"exportDefaultValue\":\"xyz\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Priority\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"12ch\"}},{\"columnMatch\":\"MetricDisplayName_s\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"53ch\"}},{\"columnMatch\":\"Count\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"11ch\"}}],\"filter\":true},\"sortBy\":[]},\"customWidth\":\"33\",\"name\":\"LA High Risk Findings\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmRisk_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where AssetLastSeen_t {_la_lastseen:query}\\r\\n|where CategoryName_s startswith_cs 'Medium'\\r\\n|extend Priority = 'Medium'\\r\\n|project-keep Priority,MetricDisplayName_s,SnapshotDateTime_t,AssetName_s\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by Priority,MetricDisplayName_s,AssetName_s\\r\\n|summarize Count=count() by Priority,MetricDisplayName_s\\r\\n|order by Count desc \",\"size\":1,\"showAnalytics\":true,\"title\":\"High Risk Findings\",\"showRefreshButton\":true,\"exportFieldName\":\"MetricDisplayName_s\",\"exportParameterName\":\"_la_risk_finding_medium\",\"exportDefaultValue\":\"xyz\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Priority\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"12ch\"}},{\"columnMatch\":\"MetricDisplayName_s\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"53ch\"}},{\"columnMatch\":\"Count\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"11ch\"}}],\"filter\":true},\"sortBy\":[]},\"customWidth\":\"33\",\"name\":\"LA Medium Risk Findings\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmRisk_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where AssetLastSeen_t {_la_lastseen:query}\\r\\n|where CategoryName_s startswith_cs 'Low'\\r\\n|extend Priority = 'Low'\\r\\n|project-keep Priority,MetricDisplayName_s,SnapshotDateTime_t,AssetName_s\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by Priority,MetricDisplayName_s,AssetName_s\\r\\n|summarize Count=count() by Priority,MetricDisplayName_s\\r\\n|order by Count desc \",\"size\":1,\"showAnalytics\":true,\"title\":\"High Risk Findings\",\"showRefreshButton\":true,\"exportFieldName\":\"MetricDisplayName_s\",\"exportParameterName\":\"_la_risk_finding_low\",\"exportDefaultValue\":\"xyz\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Priority\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"12ch\"}},{\"columnMatch\":\"MetricDisplayName_s\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"53ch\"}},{\"columnMatch\":\"Count\",\"formatter\":0,\"formatOptions\":{\"customColumnWidthSetting\":\"11ch\"}}],\"filter\":true},\"sortBy\":[]},\"customWidth\":\"33\",\"name\":\"LA Low Risk Findings\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nlet metric_name_high = '{_la_risk_finding_high}';\\r\\nlet metric_name_med = '{_la_risk_finding_medium}';\\r\\nlet metric_name_low = '{_la_risk_finding_low}';\\r\\nEasmRisk_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where AssetLastSeen_t {_la_lastseen:query}\\r\\n|where MetricDisplayName_s in (metric_name_high,metric_name_med,metric_name_low)\\r\\n|extend Priority =  case(CategoryName_s startswith_cs 'High','High',CategoryName_s startswith_cs 'Medium','Medium','Low')\\r\\n|extend PrioNum = case(Priority == 'High',1,Priority == 'Medium',2,3)\\r\\n|project-keep AssetName_s,MetricDisplayName_s,AssetLastSeen_t,AssetDescription_s,Priority,PrioNum\\r\\n|summarize hint.strategy=shuffle arg_max(AssetLastSeen_t, *) by AssetName_s,MetricDisplayName_s,AssetDescription_s,Priority,PrioNum\\r\\n|project-reorder Priority,AssetName_s\\r\\n|sort by PrioNum asc\\r\\n|project-away PrioNum\",\"size\":1,\"showAnalytics\":true,\"title\":\"Risk Details\",\"noDataMessage\":\"No risk findings found. Select a risk finding above\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"gridSettings\":{\"filter\":true}},\"name\":\"LA Risk Details\",\"styleSettings\":{\"showBorder\":true}}]},\"conditionalVisibilities\":[{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Workspace Summary\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA CVEs\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Host Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA IP Address Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Page Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA SSL Certificate Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Domain Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Web Components\"}],\"name\":\"LA Risk Findings\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"CVEs\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"37b59c82-360f-4114-a0e2-493af4089ff5\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_cvssscore\",\"label\":\"CVSS Score\",\"type\":2,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"jsonData\":\"[\\\"1\\\",\\\"2\\\",\\\"3\\\",\\\"4\\\",\\\"5\\\",\\\"6\\\",\\\"7\\\",\\\"8\\\",\\\"9\\\",\\\"10\\\"]\",\"value\":\"7\"},{\"id\":\"e730581e-d227-4a03-a0b0-f6e4ca5dd945\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_cvss3score\",\"label\":\"CVSS 3 Score\",\"type\":2,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"jsonData\":\"[\\\"1\\\",\\\"2\\\",\\\"3\\\",\\\"4\\\",\\\"5\\\",\\\"6\\\",\\\"7\\\",\\\"8\\\",\\\"9\\\",\\\"10\\\"]\",\"value\":\"7\"},{\"id\":\"6ce03701-994f-4699-8a0b-2121af3d303a\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_group_by\",\"label\":\"Group By\",\"type\":10,\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"jsonData\":\"[\\\"AssetName\\\",\\\"Cve\\\",\\\"WebComponent\\\"]\",\"value\":\"WebComponent\"}],\"style\":\"above\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"CVE Asset Score Filters\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nlet cvssscore = {_adx_cvssscore};\\\\r\\\\nlet cvss3score = {_adx_cvss3score};\\\\r\\\\nEasmAssetWebComponent\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|where array_length(WebComponentCves) != 0\\\\r\\\\n|where WebComponentLastSeen {_adx_lastseen:query}\\\\r\\\\n|mv-expand WebComponentCves\\\\r\\\\n|extend Cve = tostring(WebComponentCves.Cve), Cwe = tostring(WebComponentCves.Cwe), CvssScore = tolong(WebComponentCves.CvssScore), Cvss3Score = toreal(WebComponentCves.Cvss3Score)\\\\r\\\\n|where (CvssScore >= cvssscore or Cvss3Score >= cvss3score)\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId,WebComponentName,WebComponentVersion,Cve\\\\r\\\\n|project-keep WebComponentCategory,WebComponentName,WebComponentVersion,Cve,Cwe,CvssScore,Cvss3Score,AssetName,WebComponentLastSeen\\\\r\\\\n|project-reorder AssetName,WebComponentName,WebComponentVersion,Cve,CvssScore,Cvss3Score,Cwe\\\\r\\\\n|sort by WebComponentLastSeen desc\\\\r\\\\n//|summarize Asset = make_list(pack_all()) by AssetName\\\\r\\\\n//|summarize CVE = make_list(pack_all()) by Cve\\\\r\\\\n//|summarize WebComponent = make_list(pack_all()) by WebComponentName,WebComponentVersion\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\"Assets With CVEs\",\"showRefreshButton\":true,\"exportParameterName\":\"_asset_detail\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibilities\":[{\"parameterName\":\"_adx_group_by\",\"comparison\":\"isNotEqualTo\",\"value\":\"Cve\"},{\"parameterName\":\"_adx_group_by\",\"comparison\":\"isNotEqualTo\",\"value\":\"WebComponent\"},{\"parameterName\":\"_adx_group_by\",\"comparison\":\"isNotEqualTo\",\"value\":\"AssetName\"}],\"name\":\"ADX Assets With CVEs_no groupBy\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nlet cvssscore = {_adx_cvssscore};\\\\r\\\\nlet cvss3score = {_adx_cvss3score};\\\\r\\\\nEasmAssetWebComponent\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|where array_length(WebComponentCves) != 0\\\\r\\\\n|where WebComponentLastSeen {_adx_lastseen:query}\\\\r\\\\n|mv-expand WebComponentCves\\\\r\\\\n|extend Cve = tostring(WebComponentCves.Cve), Cwe = tostring(WebComponentCves.Cwe), CvssScore = tolong(WebComponentCves.CvssScore), Cvss3Score = toreal(WebComponentCves.Cvss3Score)\\\\r\\\\n|where (CvssScore >= cvssscore or Cvss3Score >= cvss3score)\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId,WebComponentName,WebComponentVersion,Cve\\\\r\\\\n|project-keep WebComponentCategory,WebComponentName,WebComponentVersion,Cve,Cwe,CvssScore,Cvss3Score,AssetName,WebComponentLastSeen\\\\r\\\\n//|project-reorder AssetName,WebComponentName,WebComponentVersion,Cve,CvssScore,Cvss3Score,Cwe\\\\r\\\\n//|sort by WebComponentLastSeen desc\\\\r\\\\n|summarize Asset = make_list(pack_all()) by AssetName\\\\r\\\\n//|summarize CVE = make_list(pack_all()) by Cve\\\\r\\\\n//|summarize WebComponent = make_list(pack_all()) by WebComponentName,WebComponentVersion\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\"Assets With CVEs\",\"showRefreshButton\":true,\"exportParameterName\":\"_asset_detail\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"_adx_group_by\",\"comparison\":\"isEqualTo\",\"value\":\"AssetName\"},\"name\":\"ADX Assets With CVEs_groupBy AssetName\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nlet cvssscore = {_adx_cvssscore};\\\\r\\\\nlet cvss3score = {_adx_cvss3score};\\\\r\\\\nEasmAssetWebComponent\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|where array_length(WebComponentCves) != 0\\\\r\\\\n|where WebComponentLastSeen {_adx_lastseen:query}\\\\r\\\\n|mv-expand WebComponentCves\\\\r\\\\n|extend Cve = tostring(WebComponentCves.Cve), Cwe = tostring(WebComponentCves.Cwe), CvssScore = tolong(WebComponentCves.CvssScore), Cvss3Score = toreal(WebComponentCves.Cvss3Score)\\\\r\\\\n|where (CvssScore >= cvssscore or Cvss3Score >= cvss3score)\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|project-keep WebComponentCategory,WebComponentName,WebComponentVersion,Cve,Cwe,CvssScore,Cvss3Score,AssetName,WebComponentLastSeen\\\\r\\\\n//|project-reorder AssetName,WebComponentName,WebComponentVersion,Cve,CvssScore,Cvss3Score,Cwe\\\\r\\\\n//|sort by WebComponentLastSeen desc\\\\r\\\\n//|summarize Asset = make_list(pack_all()) by AssetName\\\\r\\\\n|summarize CVE = make_list(pack_all()) by Cve\\\\r\\\\n//|summarize WebComponent = make_list(pack_all()) by WebComponentName,WebComponentVersion\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\"Assets With CVEs\",\"showRefreshButton\":true,\"exportParameterName\":\"_asset_detail\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"_adx_group_by\",\"comparison\":\"isEqualTo\",\"value\":\"Cve\"},\"name\":\"ADX Assets With CVEs_groupBy Cve\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nlet cvssscore = {_adx_cvssscore};\\\\r\\\\nlet cvss3score = {_adx_cvss3score};\\\\r\\\\nEasmAssetWebComponent\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|where array_length(WebComponentCves) != 0\\\\r\\\\n|where WebComponentLastSeen {_adx_lastseen:query}\\\\r\\\\n|mv-expand WebComponentCves\\\\r\\\\n|extend Cve = tostring(WebComponentCves.Cve), Cwe = tostring(WebComponentCves.Cwe), CvssScore = tolong(WebComponentCves.CvssScore), Cvss3Score = toreal(WebComponentCves.Cvss3Score)\\\\r\\\\n|where (CvssScore >= cvssscore or Cvss3Score >= cvss3score)\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId,WebComponentName,WebComponentVersion,Cve\\\\r\\\\n|project-keep WebComponentCategory,WebComponentName,WebComponentVersion,Cve,Cwe,CvssScore,Cvss3Score,AssetName,WebComponentLastSeen\\\\r\\\\n//|project-reorder AssetName,WebComponentName,WebComponentVersion,Cve,CvssScore,Cvss3Score,Cwe\\\\r\\\\n//|sort by WebComponentLastSeen desc\\\\r\\\\n//|summarize Asset = make_list(pack_all()) by AssetName\\\\r\\\\n//|summarize CVE = make_list(pack_all()) by Cve\\\\r\\\\n|summarize WebComponent = make_list(pack_all()) by WebComponentName,WebComponentVersion\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\"Assets With CVEs\",\"showRefreshButton\":true,\"exportParameterName\":\"_asset_detail\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"_adx_group_by\",\"comparison\":\"isEqualTo\",\"value\":\"WebComponent\"},\"name\":\"ADX Assets With CVEs_groupBy WebComponentName\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nlet cvssscore = {_adx_cvssscore};\\\\r\\\\nlet cvss3score = {_adx_cvss3score};\\\\r\\\\nlet Cves = externaldata (CveId: string )\\\\r\\\\n[\\\\r\\\\n    h@'https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv'\\\\r\\\\n]\\\\r\\\\nwith (format='csv', ingestionMapping='[{\\\\\\\"Column\\\\\\\":\\\\\\\"CveId\\\\\\\",\\\\\\\"Properties\\\\\\\":{\\\\\\\"Ordinal\\\\\\\":\\\\\\\"0\\\\\\\"}}]')\\\\r\\\\n|where CveId != 'cveID';\\\\r\\\\nCves\\\\r\\\\n| join kind=rightsemi (EasmAssetWebComponent\\\\r\\\\n    |where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n    |where array_length(WebComponentCves) != 0\\\\r\\\\n    |where WebComponentLastSeen {_adx_lastseen:query}\\\\r\\\\n    |mv-expand WebComponentCves\\\\r\\\\n    |extend Cve = tostring(WebComponentCves.Cve), Cwe = tostring(WebComponentCves.Cwe), CvssScore = tolong(WebComponentCves.CvssScore), Cvss3Score = toreal(WebComponentCves.Cvss3Score)\\\\r\\\\n    |where (CvssScore >= cvssscore or Cvss3Score >= cvss3score) \\\\r\\\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId,WebComponentName,WebComponentVersion,Cve\\\\r\\\\n    |project-keep WebComponentCategory,WebComponentName,WebComponentVersion,Cve,Cwe,CvssScore,Cvss3Score,AssetName,WebComponentLastSeen\\\\r\\\\n) on $left.CveId == $right.Cve\\\\r\\\\n|project-reorder AssetName,WebComponentName,WebComponentVersion,Cve,CvssScore,Cvss3Score,Cwe\\\\r\\\\n|sort by WebComponentLastSeen desc\\\\r\\\\n//|summarize Asset = make_list(pack_all()) by AssetName\\\\r\\\\n//|summarize CVE = make_list(pack_all()) by Cve\\\\r\\\\n//|summarize WebComponent = make_list(pack_all()) by WebComponentName,WebComponentVersion\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\"CISA Known Exploited Vulnerabilities\",\"showRefreshButton\":true,\"exportFieldName\":\"\",\"exportParameterName\":\"_asset_detail\",\"showExportToExcel\":true,\"queryType\":9,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibilities\":[{\"parameterName\":\"_adx_group_by\",\"comparison\":\"isNotEqualTo\",\"value\":\"AssetName\"},{\"parameterName\":\"_adx_group_by\",\"comparison\":\"isNotEqualTo\",\"value\":\"Cve\"},{\"parameterName\":\"_adx_group_by\",\"comparison\":\"isNotEqualTo\",\"value\":\"WebComponent\"}],\"name\":\"ADX CISA Known Exploited Vulnerabilities_no groupBy\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nlet cvssscore = {_adx_cvssscore};\\\\r\\\\nlet cvss3score = {_adx_cvss3score};\\\\r\\\\nlet Cves = externaldata (CveId: string )\\\\r\\\\n[\\\\r\\\\n    h@'https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv'\\\\r\\\\n]\\\\r\\\\nwith (format='csv', ingestionMapping='[{\\\\\\\"Column\\\\\\\":\\\\\\\"CveId\\\\\\\",\\\\\\\"Properties\\\\\\\":{\\\\\\\"Ordinal\\\\\\\":\\\\\\\"0\\\\\\\"}}]')\\\\r\\\\n|where CveId != 'cveID';\\\\r\\\\nCves\\\\r\\\\n| join kind=rightsemi (EasmAssetWebComponent\\\\r\\\\n    |where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n    |where array_length(WebComponentCves) != 0\\\\r\\\\n    |where WebComponentLastSeen {_adx_lastseen:query}\\\\r\\\\n    |mv-expand WebComponentCves\\\\r\\\\n    |extend Cve = tostring(WebComponentCves.Cve), Cwe = tostring(WebComponentCves.Cwe), CvssScore = tolong(WebComponentCves.CvssScore), Cvss3Score = toreal(WebComponentCves.Cvss3Score)\\\\r\\\\n    |where (CvssScore >= cvssscore or Cvss3Score >= cvss3score)\\\\r\\\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId,WebComponentName,WebComponentVersion,Cve\\\\r\\\\n    |project-keep WebComponentCategory,WebComponentName,WebComponentVersion,Cve,Cwe,CvssScore,Cvss3Score,AssetName,WebComponentLastSeen\\\\r\\\\n) on $left.CveId == $right.Cve\\\\r\\\\n//|project-reorder AssetName,WebComponentName,WebComponentVersion,Cve,CvssScore,Cvss3Score,Cwe\\\\r\\\\n//|sort by WebComponentLastSeen desc\\\\r\\\\n|summarize Asset = make_list(pack_all()) by AssetName\\\\r\\\\n//|summarize CVE = make_list(pack_all()) by Cve\\\\r\\\\n//|summarize WebComponent = make_list(pack_all()) by WebComponentName,WebComponentVersion\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\"CISA Known Exploited Vulnerabilities\",\"showRefreshButton\":true,\"exportFieldName\":\"\",\"exportParameterName\":\"_asset_detail\",\"showExportToExcel\":true,\"queryType\":9,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"_adx_group_by\",\"comparison\":\"isEqualTo\",\"value\":\"AssetName\"},\"name\":\"ADX CISA Known Exploited Vulnerabilities_groupBy AssetName\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nlet cvssscore = {_adx_cvssscore};\\\\r\\\\nlet cvss3score = {_adx_cvss3score};\\\\r\\\\nlet Cves = externaldata (CveId: string )\\\\r\\\\n[\\\\r\\\\n    h@'https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv'\\\\r\\\\n]\\\\r\\\\nwith (format='csv', ingestionMapping='[{\\\\\\\"Column\\\\\\\":\\\\\\\"CveId\\\\\\\",\\\\\\\"Properties\\\\\\\":{\\\\\\\"Ordinal\\\\\\\":\\\\\\\"0\\\\\\\"}}]')\\\\r\\\\n|where CveId != 'cveID';\\\\r\\\\nCves\\\\r\\\\n| join kind=rightsemi (EasmAssetWebComponent\\\\r\\\\n    |where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n    |where array_length(WebComponentCves) != 0\\\\r\\\\n    |where WebComponentLastSeen {_adx_lastseen:query}\\\\r\\\\n    |mv-expand WebComponentCves\\\\r\\\\n    |extend Cve = tostring(WebComponentCves.Cve), Cwe = tostring(WebComponentCves.Cwe), CvssScore = tolong(WebComponentCves.CvssScore), Cvss3Score = toreal(WebComponentCves.Cvss3Score)\\\\r\\\\n    |where (CvssScore >= cvssscore or Cvss3Score >= cvss3score) \\\\r\\\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId,WebComponentName,WebComponentVersion,Cve\\\\r\\\\n    |project-keep WebComponentCategory,WebComponentName,WebComponentVersion,Cve,Cwe,CvssScore,Cvss3Score,AssetName,WebComponentLastSeen\\\\r\\\\n) on $left.CveId == $right.Cve\\\\r\\\\n//|project-reorder AssetName,WebComponentName,WebComponentVersion,Cve,CvssScore,Cvss3Score,Cwe\\\\r\\\\n//|sort by WebComponentLastSeen desc\\\\r\\\\n//|summarize Asset = make_list(pack_all()) by AssetName\\\\r\\\\n|summarize CVE = make_list(pack_all()) by Cve\\\\r\\\\n//|summarize WebComponent = make_list(pack_all()) by WebComponentName,WebComponentVersion\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\"CISA Known Exploited Vulnerabilities\",\"showRefreshButton\":true,\"exportFieldName\":\"\",\"exportParameterName\":\"_asset_detail\",\"showExportToExcel\":true,\"queryType\":9,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"_adx_group_by\",\"comparison\":\"isEqualTo\",\"value\":\"Cve\"},\"name\":\"ADX CISA Known Exploited Vulnerabilities_groupBy Cve\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nlet cvssscore = {_adx_cvssscore};\\\\r\\\\nlet cvss3score = {_adx_cvss3score};\\\\r\\\\nlet Cves = externaldata (CveId: string )\\\\r\\\\n[\\\\r\\\\n    h@'https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv'\\\\r\\\\n]\\\\r\\\\nwith (format='csv', ingestionMapping='[{\\\\\\\"Column\\\\\\\":\\\\\\\"CveId\\\\\\\",\\\\\\\"Properties\\\\\\\":{\\\\\\\"Ordinal\\\\\\\":\\\\\\\"0\\\\\\\"}}]')\\\\r\\\\n|where CveId != 'cveID';\\\\r\\\\nCves\\\\r\\\\n| join kind=rightsemi (EasmAssetWebComponent\\\\r\\\\n    |where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n    |where array_length(WebComponentCves) != 0\\\\r\\\\n    |where WebComponentLastSeen {_adx_lastseen:query}\\\\r\\\\n    |mv-expand WebComponentCves\\\\r\\\\n    |extend Cve = tostring(WebComponentCves.Cve), Cwe = tostring(WebComponentCves.Cwe), CvssScore = tolong(WebComponentCves.CvssScore), Cvss3Score = toreal(WebComponentCves.Cvss3Score)\\\\r\\\\n    |where (CvssScore >= cvssscore or Cvss3Score >= cvss3score)\\\\r\\\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId,WebComponentName,WebComponentVersion,Cve\\\\r\\\\n    |project-keep WebComponentCategory,WebComponentName,WebComponentVersion,Cve,Cwe,CvssScore,Cvss3Score,AssetName,WebComponentLastSeen\\\\r\\\\n) on $left.CveId == $right.Cve\\\\r\\\\n//|project-reorder AssetName,WebComponentName,WebComponentVersion,Cve,CvssScore,Cvss3Score,Cwe\\\\r\\\\n//|sort by WebComponentLastSeen desc\\\\r\\\\n//|summarize Asset = make_list(pack_all()) by AssetName\\\\r\\\\n//|summarize CVE = make_list(pack_all()) by Cve\\\\r\\\\n|summarize WebComponent = make_list(pack_all()) by WebComponentName,WebComponentVersion\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\"CISA Known Exploited Vulnerabilities\",\"showRefreshButton\":true,\"exportFieldName\":\"\",\"exportParameterName\":\"_asset_detail\",\"showExportToExcel\":true,\"queryType\":9,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"_adx_group_by\",\"comparison\":\"isEqualTo\",\"value\":\"WebComponent\"},\"name\":\"ADX CISA Known Exploited Vulnerabilities_groupBy WebComponent\",\"styleSettings\":{\"showBorder\":true}}]},\"conditionalVisibilities\":[{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Workspace Summary\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Risk Findings\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Host Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX IP Address Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Page Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX SSL Certificate Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Domain Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Web Components\"}],\"name\":\"ADX CVEs\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"CVEs\",\"items\":[{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"37b59c82-360f-4114-a0e2-493af4089ff5\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_cvssscore\",\"label\":\"CVSS Score\",\"type\":2,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"jsonData\":\"[\\\"1\\\",\\\"2\\\",\\\"3\\\",\\\"4\\\",\\\"5\\\",\\\"6\\\",\\\"7\\\",\\\"8\\\",\\\"9\\\",\\\"10\\\"]\",\"value\":\"7\"},{\"id\":\"e730581e-d227-4a03-a0b0-f6e4ca5dd945\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_cvss3score\",\"label\":\"CVSS 3 Score\",\"type\":2,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"jsonData\":\"[\\\"1\\\",\\\"2\\\",\\\"3\\\",\\\"4\\\",\\\"5\\\",\\\"6\\\",\\\"7\\\",\\\"8\\\",\\\"9\\\",\\\"10\\\"]\",\"value\":\"7\"},{\"id\":\"6ce03701-994f-4699-8a0b-2121af3d303a\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_group_by\",\"label\":\"Group By\",\"type\":10,\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"jsonData\":\"[\\\"AssetName\\\",\\\"Cve\\\",\\\"WebComponent\\\"]\"}],\"style\":\"above\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"CVE Asset Score Filters\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nlet cvssscore = {_la_cvssscore};\\r\\nlet cvss3score = {_la_cvss3score};\\r\\nEasmAssetWebComponent_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|where isnotempty(WebComponentCves_s)\\r\\n|where WebComponentLastSeen_t {_la_lastseen:query}\\r\\n|extend WebComponentCves_j = parse_json(WebComponentCves_s)\\r\\n|mv-expand WebComponentCves_j\\r\\n|extend Cve = tostring(WebComponentCves_j.Cve), Cwe = tostring(WebComponentCves_j.Cwe), CvssScore = tolong(WebComponentCves_j.CvssScore), Cvss3Score = toreal(WebComponentCves_j.Cvss3Score)\\r\\n|where (CvssScore >= cvssscore or Cvss3Score >= cvss3score)\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s,WebComponentName_s,WebComponentVersion_s,Cve\\r\\n|project-keep WebComponentCategory_s,WebComponentName_s,WebComponentVersion_s,Cve,Cwe,CvssScore,Cvss3Score,AssetName_s,WebComponentLastSeen_t\\r\\n|project-reorder AssetName_s,WebComponentName_s,WebComponentVersion_s,Cve,CvssScore,Cvss3Score,Cwe\\r\\n|sort by WebComponentLastSeen_t desc\\r\\n//|summarize Asset = make_list(pack_all()) by AssetName_s\\r\\n//|summarize CVE = make_list(pack_all()) by Cve\\r\\n//|summarize WebComponent = make_list(pack_all()) by WebComponentName_s,WebComponentVersion_s\",\"size\":1,\"showAnalytics\":true,\"title\":\"Assets With CVEs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibilities\":[{\"parameterName\":\"_la_group_by\",\"comparison\":\"isNotEqualTo\",\"value\":\"Cve\"},{\"parameterName\":\"_la_group_by\",\"comparison\":\"isNotEqualTo\",\"value\":\"WebComponent\"},{\"parameterName\":\"_la_group_by\",\"comparison\":\"isNotEqualTo\",\"value\":\"AssetName\"}],\"name\":\"LA Assets With CVEs_no groupBy\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nlet cvssscore = {_la_cvssscore};\\r\\nlet cvss3score = {_la_cvss3score};\\r\\nEasmAssetWebComponent_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|where isnotempty(WebComponentCves_s)\\r\\n|where WebComponentLastSeen_t {_la_lastseen:query}\\r\\n|extend WebComponentCves_j = parse_json(WebComponentCves_s)\\r\\n|mv-expand WebComponentCves_j\\r\\n|extend Cve = tostring(WebComponentCves_j.Cve), Cwe = tostring(WebComponentCves_j.Cwe), CvssScore = tolong(WebComponentCves_j.CvssScore), Cvss3Score = toreal(WebComponentCves_j.Cvss3Score)\\r\\n|where (CvssScore >= cvssscore or Cvss3Score >= cvss3score)\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s,WebComponentName_s,WebComponentVersion_s,Cve\\r\\n|project-keep WebComponentCategory_s,WebComponentName_s,WebComponentVersion_s,Cve,Cwe,CvssScore,Cvss3Score,AssetName_s,WebComponentLastSeen_t\\r\\n//|project-reorder AssetName_s,WebComponentName_s,WebComponentVersion_s,Cve,CvssScore,Cvss3Score,Cwe\\r\\n//|sort by WebComponentLastSeen_t desc\\r\\n|summarize Asset = make_list(pack_all()) by AssetName_s\\r\\n//|summarize CVE = make_list(pack_all()) by Cve\\r\\n//|summarize WebComponent = make_list(pack_all()) by WebComponentName_s,WebComponentVersion_s\",\"size\":1,\"showAnalytics\":true,\"title\":\"Assets With CVEs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true,\"sortBy\":[{\"itemKey\":\"AssetName_s\",\"sortOrder\":1}]},\"sortBy\":[{\"itemKey\":\"AssetName_s\",\"sortOrder\":1}]},\"conditionalVisibility\":{\"parameterName\":\"_la_group_by\",\"comparison\":\"isEqualTo\",\"value\":\"AssetName\"},\"name\":\"LA Assets With CVEs_groupBy AssetName\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nlet cvssscore = {_la_cvssscore};\\r\\nlet cvss3score = {_la_cvss3score};\\r\\nEasmAssetWebComponent_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|where isnotempty(WebComponentCves_s)\\r\\n|where WebComponentLastSeen_t {_la_lastseen:query}\\r\\n|extend WebComponentCves_j = parse_json(WebComponentCves_s)\\r\\n|mv-expand WebComponentCves_j\\r\\n|extend Cve = tostring(WebComponentCves_j.Cve), Cwe = tostring(WebComponentCves_j.Cwe), CvssScore = tolong(WebComponentCves_j.CvssScore), Cvss3Score = toreal(WebComponentCves_j.Cvss3Score)\\r\\n|where (CvssScore >= cvssscore or Cvss3Score >= cvss3score)\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s,WebComponentName_s,WebComponentVersion_s,Cve\\r\\n|project-keep WebComponentCategory_s,WebComponentName_s,WebComponentVersion_s,Cve,Cwe,CvssScore,Cvss3Score,AssetName_s,WebComponentLastSeen_t\\r\\n//|project-reorder AssetName_s,WebComponentName_s,WebComponentVersion_s,Cve,CvssScore,Cvss3Score,Cwe\\r\\n//|sort by WebComponentLastSeen_t desc\\r\\n//|summarize Asset = make_list(pack_all()) by AssetName_s\\r\\n|summarize CVE = make_list(pack_all()) by Cve\\r\\n//|summarize WebComponent = make_list(pack_all()) by WebComponentName_s,WebComponentVersion_s\",\"size\":1,\"showAnalytics\":true,\"title\":\"Assets With CVEs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true,\"sortBy\":[{\"itemKey\":\"Cve\",\"sortOrder\":1}]},\"sortBy\":[{\"itemKey\":\"Cve\",\"sortOrder\":1}]},\"conditionalVisibility\":{\"parameterName\":\"_la_group_by\",\"comparison\":\"isEqualTo\",\"value\":\"Cve\"},\"name\":\"LA Assets With CVEs_groupBy Cve\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nlet cvssscore = {_la_cvssscore};\\r\\nlet cvss3score = {_la_cvss3score};\\r\\nEasmAssetWebComponent_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|where isnotempty(WebComponentCves_s)\\r\\n|where WebComponentLastSeen_t {_la_lastseen:query}\\r\\n|extend WebComponentCves_j = parse_json(WebComponentCves_s)\\r\\n|mv-expand WebComponentCves_j\\r\\n|extend Cve = tostring(WebComponentCves_j.Cve), Cwe = tostring(WebComponentCves_j.Cwe), CvssScore = tolong(WebComponentCves_j.CvssScore), Cvss3Score = toreal(WebComponentCves_j.Cvss3Score)\\r\\n|where (CvssScore >= cvssscore or Cvss3Score >= cvss3score)\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s,WebComponentName_s,WebComponentVersion_s,Cve\\r\\n|project-keep WebComponentCategory_s,WebComponentName_s,WebComponentVersion_s,Cve,Cwe,CvssScore,Cvss3Score,AssetName_s,WebComponentLastSeen_t\\r\\n//|project-reorder AssetName_s,WebComponentName_s,WebComponentVersion_s,Cve,CvssScore,Cvss3Score,Cwe\\r\\n//|sort by WebComponentLastSeen_t desc\\r\\n//|summarize Asset = make_list(pack_all()) by AssetName_s\\r\\n//|summarize CVE = make_list(pack_all()) by Cve\\r\\n|summarize WebComponent = make_list(pack_all()) by WebComponentName_s,WebComponentVersion_s\",\"size\":1,\"showAnalytics\":true,\"title\":\"Assets With CVEs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"_la_group_by\",\"comparison\":\"isEqualTo\",\"value\":\"WebComponent\"},\"name\":\"LA Assets With CVEs_groupBy WebComponent\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nlet cvssscore = {_la_cvssscore};\\r\\nlet cvss3score = {_la_cvss3score};\\r\\nlet Cves = externaldata (CveId: string )\\r\\n[\\r\\n    h@'https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv'\\r\\n]\\r\\nwith (format='csv', ingestionMapping='[{\\\"Column\\\":\\\"CveId\\\",\\\"Properties\\\":{\\\"Ordinal\\\":\\\"0\\\"}}]')\\r\\n|where CveId != 'cveID';\\r\\nCves\\r\\n| join kind=rightsemi (EasmAssetWebComponent_CL\\r\\n    |where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n    |where isnotempty(WebComponentCves_s)\\r\\n    |where WebComponentLastSeen_t {_la_lastseen:query}\\r\\n    |extend WebComponentCves_j = parse_json(WebComponentCves_s)\\r\\n    |mv-expand WebComponentCves_j\\r\\n    |extend Cve = tostring(WebComponentCves_j.Cve), Cwe = tostring(WebComponentCves_j.Cwe), CvssScore = tolong(WebComponentCves_j.CvssScore), Cvss3Score = toreal(WebComponentCves_j.Cvss3Score)\\r\\n    |where (CvssScore >= cvssscore or Cvss3Score >= cvss3score)\\r\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s,WebComponentName_s,WebComponentVersion_s,Cve\\r\\n    |project-keep WebComponentCategory_s,WebComponentName_s,WebComponentVersion_s,Cve,Cwe,CvssScore,Cvss3Score,AssetName_s,WebComponentLastSeen_t\\r\\n) on $left.CveId == $right.Cve\\r\\n|project-reorder AssetName_s,WebComponentName_s,WebComponentVersion_s,Cve,CvssScore,Cvss3Score,Cwe\\r\\n|sort by WebComponentLastSeen_t desc\\r\\n//|summarize Asset = make_list(pack_all()) by AssetName_s\\r\\n//|summarize CVE = make_list(pack_all()) by Cve\\r\\n//|summarize WebComponent = make_list(pack_all()) by WebComponentName_s,WebComponentVersion_s\",\"size\":1,\"showAnalytics\":true,\"title\":\"CISA Known Exploited Vulnerabilities\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibilities\":[{\"parameterName\":\"_la_group_by\",\"comparison\":\"isNotEqualTo\",\"value\":\"AssetName\"},{\"parameterName\":\"_la_group_by\",\"comparison\":\"isNotEqualTo\",\"value\":\"Cve\"},{\"parameterName\":\"_la_group_by\",\"comparison\":\"isNotEqualTo\",\"value\":\"WebComponent\"}],\"name\":\"LA CISA Known Exploited Vulnerabilities_no groupBy\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nlet cvssscore = {_la_cvssscore};\\r\\nlet cvss3score = {_la_cvss3score};\\r\\nlet Cves = externaldata (CveId: string )\\r\\n[\\r\\n    h@'https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv'\\r\\n]\\r\\nwith (format='csv', ingestionMapping='[{\\\"Column\\\":\\\"CveId\\\",\\\"Properties\\\":{\\\"Ordinal\\\":\\\"0\\\"}}]')\\r\\n|where CveId != 'cveID';\\r\\nCves\\r\\n| join kind=rightsemi (EasmAssetWebComponent_CL\\r\\n    |where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n    |where isnotempty(WebComponentCves_s)\\r\\n    |where WebComponentLastSeen_t {_la_lastseen:query}\\r\\n    |extend WebComponentCves_j = parse_json(WebComponentCves_s)\\r\\n    |mv-expand WebComponentCves_j\\r\\n    |extend Cve = tostring(WebComponentCves_j.Cve), Cwe = tostring(WebComponentCves_j.Cwe), CvssScore = tolong(WebComponentCves_j.CvssScore), Cvss3Score = toreal(WebComponentCves_j.Cvss3Score)\\r\\n    |where (CvssScore >= cvssscore or Cvss3Score >= cvss3score)\\r\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s,WebComponentName_s,WebComponentVersion_s,Cve\\r\\n    |project-keep WebComponentCategory_s,WebComponentName_s,WebComponentVersion_s,Cve,Cwe,CvssScore,Cvss3Score,AssetName_s,WebComponentLastSeen_t\\r\\n) on $left.CveId == $right.Cve\\r\\n//|project-reorder AssetName_s,WebComponentName_s,WebComponentVersion_s,Cve,CvssScore,Cvss3Score,Cwe\\r\\n//|sort by WebComponentLastSeen_t desc\\r\\n|summarize Asset = make_list(pack_all()) by AssetName_s\\r\\n//|summarize CVE = make_list(pack_all()) by Cve\\r\\n//|summarize WebComponent = make_list(pack_all()) by WebComponentName_s,WebComponentVersion_s\",\"size\":1,\"showAnalytics\":true,\"title\":\"CISA Known Exploited Vulnerabilities\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"_la_group_by\",\"comparison\":\"isEqualTo\",\"value\":\"AssetName\"},\"name\":\"LA CISA Known Exploited Vulnerabilities_groupBy AssetName\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nlet cvssscore = {_la_cvssscore};\\r\\nlet cvss3score = {_la_cvss3score};\\r\\nlet Cves = externaldata (CveId: string )\\r\\n[\\r\\n    h@'https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv'\\r\\n]\\r\\nwith (format='csv', ingestionMapping='[{\\\"Column\\\":\\\"CveId\\\",\\\"Properties\\\":{\\\"Ordinal\\\":\\\"0\\\"}}]')\\r\\n|where CveId != 'cveID';\\r\\nCves\\r\\n| join kind=rightsemi (EasmAssetWebComponent_CL\\r\\n    |where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n    |where isnotempty(WebComponentCves_s)\\r\\n    |where WebComponentLastSeen_t {_la_lastseen:query}\\r\\n    |extend WebComponentCves_j = parse_json(WebComponentCves_s)\\r\\n    |mv-expand WebComponentCves_j\\r\\n    |extend Cve = tostring(WebComponentCves_j.Cve), Cwe = tostring(WebComponentCves_j.Cwe), CvssScore = tolong(WebComponentCves_j.CvssScore), Cvss3Score = toreal(WebComponentCves_j.Cvss3Score)\\r\\n    |where (CvssScore >= cvssscore or Cvss3Score >= cvss3score)\\r\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s,WebComponentName_s,WebComponentVersion_s,Cve\\r\\n    |project-keep WebComponentCategory_s,WebComponentName_s,WebComponentVersion_s,Cve,Cwe,CvssScore,Cvss3Score,AssetName_s,WebComponentLastSeen_t\\r\\n) on $left.CveId == $right.Cve\\r\\n//|project-reorder AssetName_s,WebComponentName_s,WebComponentVersion_s,Cve,CvssScore,Cvss3Score,Cwe\\r\\n//|sort by WebComponentLastSeen_t desc\\r\\n//|summarize Asset = make_list(pack_all()) by AssetName_s\\r\\n|summarize CVE = make_list(pack_all()) by Cve\\r\\n//|summarize WebComponent = make_list(pack_all()) by WebComponentName_s,WebComponentVersion_s\",\"size\":1,\"showAnalytics\":true,\"title\":\"CISA Known Exploited Vulnerabilities\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"_la_group_by\",\"comparison\":\"isEqualTo\",\"value\":\"Cve\"},\"name\":\"LA CISA Known Exploited Vulnerabilities_groupBy Cve\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nlet cvssscore = {_la_cvssscore};\\r\\nlet cvss3score = {_la_cvss3score};\\r\\nlet Cves = externaldata (CveId: string )\\r\\n[\\r\\n    h@'https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv'\\r\\n]\\r\\nwith (format='csv', ingestionMapping='[{\\\"Column\\\":\\\"CveId\\\",\\\"Properties\\\":{\\\"Ordinal\\\":\\\"0\\\"}}]')\\r\\n|where CveId != 'cveID';\\r\\nCves\\r\\n| join kind=rightsemi (EasmAssetWebComponent_CL\\r\\n    |where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n    |where isnotempty(WebComponentCves_s)\\r\\n    |where WebComponentLastSeen_t {_la_lastseen:query}\\r\\n    |extend WebComponentCves_j = parse_json(WebComponentCves_s)\\r\\n    |mv-expand WebComponentCves_j\\r\\n    |extend Cve = tostring(WebComponentCves_j.Cve), Cwe = tostring(WebComponentCves_j.Cwe), CvssScore = tolong(WebComponentCves_j.CvssScore), Cvss3Score = toreal(WebComponentCves_j.Cvss3Score)\\r\\n    |where (CvssScore >= cvssscore or Cvss3Score >= cvss3score)\\r\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s,WebComponentName_s,WebComponentVersion_s,Cve\\r\\n    |project-keep WebComponentCategory_s,WebComponentName_s,WebComponentVersion_s,Cve,Cwe,CvssScore,Cvss3Score,AssetName_s,WebComponentLastSeen_t\\r\\n) on $left.CveId == $right.Cve\\r\\n//|project-reorder AssetName_s,WebComponentName_s,WebComponentVersion_s,Cve,CvssScore,Cvss3Score,Cwe\\r\\n//|sort by WebComponentLastSeen_t desc\\r\\n//|summarize Asset = make_list(pack_all()) by AssetName_s\\r\\n//|summarize CVE = make_list(pack_all()) by Cve\\r\\n|summarize WebComponent = make_list(pack_all()) by WebComponentName_s,WebComponentVersion_s\",\"size\":1,\"showAnalytics\":true,\"title\":\"CISA Known Exploited Vulnerabilities\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"conditionalVisibility\":{\"parameterName\":\"_la_group_by\",\"comparison\":\"isEqualTo\",\"value\":\"WebComponent\"},\"name\":\"LA CISA Known Exploited Vulnerabilities_groupBy WebComponent\",\"styleSettings\":{\"showBorder\":true}}]},\"conditionalVisibilities\":[{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Workspace Summary\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Risk Findings\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Host Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA IP Address Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Page Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA SSL Certificate Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Domain Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Web Components\"}],\"name\":\"LA CVEs\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"Web Component Details\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmAssetWebComponent\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n|where WebComponentLastSeen {_adx_lastseen:query}\\\\r\\\\n|project-keep AssetName,WebComponentName,WebComponentCategory,WebComponentVersion,WebComponentFirstSeen,WebComponentLastSeen\\\\r\\\\n|project-reorder AssetName,WebComponentName,WebComponentCategory,WebComponentVersion\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"Web Components Search\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"rowLimit\":5000,\"filter\":true}},\"name\":\"ADX WebComponents Search\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmAssetWebComponent\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n|where WebComponentCategory == 'Expired Service'\\\\r\\\\n|where WebComponentLastSeen {_adx_lastseen:query}\\\\r\\\\n|project-keep AssetName,WebComponentName,WebComponentFirstSeen,WebComponentLastSeen\\\\r\\\\n|project-reorder AssetName,WebComponentName\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"Assets with Expired Web Services\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"customWidth\":\"50\",\"name\":\"ADX WebComponents with ExpiredService\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmAssetWebComponent\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n|where WebComponentCategory == 'Remote Access'\\\\r\\\\n|where WebComponentLastSeen {_adx_lastseen:query}\\\\r\\\\n|project-keep AssetName,WebComponentName,WebComponentFirstSeen,WebComponentLastSeen\\\\r\\\\n|project-reorder AssetName,WebComponentName\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"Assets with Remote Access\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"customWidth\":\"50\",\"name\":\"ADX WebComponents with RemoteAccess\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmAssetWebComponent\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n|where WebComponentCategory == 'CAPTCHA'\\\\r\\\\n|where WebComponentLastSeen {_adx_lastseen:query}\\\\r\\\\n|project-keep AssetName,WebComponentName,WebComponentFirstSeen,WebComponentLastSeen\\\\r\\\\n|project-reorder AssetName,WebComponentName\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"Assets with CAPTCHAs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"customWidth\":\"50\",\"name\":\"ADX WebComponents with CAPTCHAs\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmAssetWebComponent\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n|where WebComponentCategory == 'DDOS Protection'\\\\r\\\\n|where WebComponentLastSeen {_adx_lastseen:query}\\\\r\\\\n|project-keep AssetName,WebComponentName,WebComponentFirstSeen,WebComponentLastSeen\\\\r\\\\n|project-reorder AssetName,WebComponentName\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"Assets with DDOS Protection\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"customWidth\":\"50\",\"name\":\"ADX WebComponents with DDOS Protection\"}]},\"conditionalVisibilities\":[{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Workspace Summary\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Risk Findings\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Host Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX IP Address Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Page Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX SSL Certificate Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Domain Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX CVEs\"}],\"name\":\"ADX Web Components\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"Web Component Details\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmAssetWebComponent_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n|where WebComponentLastSeen_t {_la_lastseen:query}\\r\\n|project-keep AssetName_s,WebComponentName_s,WebComponentCategory_s,WebComponentVersion_s,WebComponentFirstSeen_t,WebComponentLastSeen_t\\r\\n|project-reorder AssetName_s,WebComponentName_s,WebComponentCategory_s,WebComponentVersion_s\",\"size\":0,\"showAnalytics\":true,\"title\":\"Web Components Search\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"rowLimit\":5000,\"filter\":true},\"sortBy\":[]},\"name\":\"LA WebComponents Search\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmAssetWebComponent_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n|where WebComponentCategory_s == 'Expired Service'\\r\\n//|where WebComponentLastSeen_t {_la_lastseen:query}\\r\\n|project-keep AssetName_s,WebComponentName_s,WebComponentFirstSeen_t,WebComponentLastSeen_t\\r\\n|project-reorder AssetName_s,WebComponentName_s\",\"size\":0,\"showAnalytics\":true,\"title\":\"Assets with Expired Web Services\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true},\"sortBy\":[]},\"customWidth\":\"50\",\"name\":\"LA WebComponents with ExpiredService\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmAssetWebComponent_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n|where WebComponentCategory_s == 'Remote Access'\\r\\n|where WebComponentLastSeen_t {_la_lastseen:query}\\r\\n|project-keep AssetName_s,WebComponentName_s,WebComponentFirstSeen_t,WebComponentLastSeen_t\\r\\n|project-reorder AssetName_s,WebComponentName_s\",\"size\":0,\"showAnalytics\":true,\"title\":\"Assets with Remote Access\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true},\"sortBy\":[]},\"customWidth\":\"50\",\"name\":\"LA WebComponents with RemoteAccess\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmAssetWebComponent_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n|where WebComponentCategory_s == 'CAPTCHA'\\r\\n|where WebComponentLastSeen_t {_la_lastseen:query}\\r\\n|project-keep AssetName_s,WebComponentName_s,WebComponentFirstSeen_t,WebComponentLastSeen_t\\r\\n|project-reorder AssetName_s,WebComponentName_s\",\"size\":0,\"showAnalytics\":true,\"title\":\"Assets with CAPTCHAs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true},\"sortBy\":[]},\"customWidth\":\"50\",\"name\":\"LA WebComponents with CAPTCHAs\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmAssetWebComponent_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n|where WebComponentCategory_s == 'DDOS Protection'\\r\\n|where WebComponentLastSeen_t {_la_lastseen:query}\\r\\n|project-keep AssetName_s,WebComponentName_s,WebComponentFirstSeen_t,WebComponentLastSeen_t\\r\\n|project-reorder AssetName_s,WebComponentName_s\",\"size\":0,\"showAnalytics\":true,\"title\":\"Assets with DDOS Protection\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"showExpandCollapseGrid\":true,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true},\"sortBy\":[]},\"customWidth\":\"50\",\"name\":\"LA WebComponents with DDOS Protection\"}]},\"conditionalVisibilities\":[{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Workspace Summary\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Risk Findings\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Host Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA IP Address Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Page Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA SSL Certificate Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Domain Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA CVEs\"}],\"name\":\"LA Web Components\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"Host Details\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|where AssetType == 'HOST'\\\\r\\\\n|summarize Count=count() by AssetType,SnapshotDateTime\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"Hosts Over Time\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"timechart\"},\"name\":\"ADX Hosts Over Time\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"5f1dde0d-e3a4-4908-b7e1-05b9bcbf8844\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_host_sort_order\",\"label\":\"Sort Order\",\"type\":10,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"asc\\\",\\\"desc\\\"]\",\"timeContext\":{\"durationMs\":86400000},\"value\":\"desc\"}],\"style\":\"formHorizontal\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"ADX Host Sorting\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmHostAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n|extend Domain = iff(isnotempty(Domain), Domain, Host)\\\\r\\\\n|summarize Count=count() by Domain\\\\r\\\\n|sort by Count {_adx_host_sort_order}\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"Hosts by Domain\",\"showRefreshButton\":true,\"exportFieldName\":\"Domain\",\"exportParameterName\":\"_adx_domain_name\",\"exportDefaultValue\":\"No Domain Selected\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"tiles\",\"gridSettings\":{\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"Domain\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":true,\"sortOrderField\":1,\"size\":\"auto\"}},\"customWidth\":\"70\",\"name\":\"ADX Hosts by Domain\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmHostAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n|where Domain == '{_adx_domain_name}'\\\\r\\\\n|project-keep Host\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"showAnalytics\":true,\"title\":\"Hosts Lookup for '{_adx_domain_name}'\",\"noDataMessage\":\"Select a Domain to find related Hosts\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9},\"customWidth\":\"30\",\"name\":\"ADX Hosts Lookup\"}]},\"conditionalVisibilities\":[{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Workspace Summary\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Risk Findings\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX CVEs\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX IP Address Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Page Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX SSL Certificate Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Domain Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Web Components\"}],\"name\":\"ADX Host Details\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"Host Details\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|where AssetType_s == 'HOST'\\r\\n|summarize Count=count() by AssetType_s,SnapshotDateTime_t\",\"size\":1,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"Hosts Over Time\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"timechart\"},\"name\":\"LA Hosts Over Time\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"5f1dde0d-e3a4-4908-b7e1-05b9bcbf8844\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_host_sort_order\",\"label\":\"Sort Order\",\"type\":10,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"asc\\\",\\\"desc\\\"]\",\"timeContext\":{\"durationMs\":86400000},\"value\":\"asc\"}],\"style\":\"formHorizontal\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"LA Host Sorting\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmHostAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n|extend Domain = iff(isnotempty(Domain_s), Domain_s, Host_s)\\r\\n//|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by Domain,AssetName\\r\\n|summarize Count=count() by Domain\\r\\n|sort by Count {_la_host_sort_order}\",\"size\":0,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"Hosts by Domain\",\"showRefreshButton\":true,\"exportFieldName\":\"Domain\",\"exportParameterName\":\"_la_domain_name\",\"exportDefaultValue\":\"No Domain Selected\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"tiles\",\"gridSettings\":{\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"Domain\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":true,\"sortOrderField\":1,\"size\":\"auto\"}},\"customWidth\":\"70\",\"name\":\"LA Hosts by Domain\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmHostAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n|where Domain_s == '{_la_domain_name}'\\r\\n|project-keep Host_s\",\"size\":0,\"showAnalytics\":true,\"title\":\"Hosts Lookup for '{_la_domain_name}'\",\"noDataMessage\":\"Select a Domain to find related Hosts\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"customWidth\":\"30\",\"name\":\"LA Hosts Lookup by Domain\"}]},\"conditionalVisibilities\":[{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Workspace Summary\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Risk Findings\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA CVEs\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA IP Address Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Page Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA SSL Certificate Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Domain Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Web Components\"}],\"name\":\"LA Host Details\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"IP Address Details\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|where AssetType == 'IP_ADDRESS'\\\\r\\\\n|summarize Count=count() by AssetType,SnapshotDateTime\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"IPs Over Time\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"timechart\"},\"name\":\"ADX IPs Over Time\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"5f1dde0d-e3a4-4908-b7e1-05b9bcbf8844\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_ip_sort_order\",\"label\":\"Sort Order\",\"type\":10,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"asc\\\",\\\"desc\\\"]\",\"timeContext\":{\"durationMs\":86400000},\"value\":\"desc\"}],\"style\":\"formHorizontal\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"ADX IP Sorting\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmIpAddressAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n|where array_length(IpBlocks) > 0\\\\r\\\\n|extend ReversedBlock = array_reverse(IpBlocks)\\\\r\\\\n|extend IpBlock = array_slice(ReversedBlock,0,0)\\\\r\\\\n|extend IpBlock = tostring(strcat_array(IpBlock,''))\\\\r\\\\n|where isnotempty(IpBlock)\\\\r\\\\n|summarize Count=count() by IpBlock\\\\r\\\\n|sort by Count {_adx_ip_sort_order}\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"IPs by Block\",\"showRefreshButton\":true,\"exportFieldName\":\"IpBlock\",\"exportParameterName\":\"_adx_ip_block\",\"exportDefaultValue\":\"No IP Block Selected\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"tiles\",\"gridSettings\":{\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"IpBlock\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":true,\"sortOrderField\":1,\"size\":\"auto\"}},\"customWidth\":\"80\",\"name\":\"ADX IPs by Block\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmIpAddressAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n|where IpBlocks has '{_adx_ip_block}'\\\\r\\\\n|project-keep IpAddress\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"IPs Lookup for '{_adx_ip_block}'\",\"noDataMessage\":\"Select an IP Block to find active IPs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"gridSettings\":{\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"IpBlock\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":true,\"sortOrderField\":1,\"size\":\"auto\"}},\"customWidth\":\"20\",\"name\":\"ADX IPs Lookup by IP Block\"}]},\"conditionalVisibilities\":[{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Workspace Summary\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Risk Findings\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX CVEs\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Host Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Page Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX SSL Certificate Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Domain Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Web Components\"}],\"name\":\"ADX IP Address Details\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"IP Address Details\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|where AssetType_s == 'IP_ADDRESS'\\r\\n|summarize Count=count() by AssetType_s,SnapshotDateTime_t\",\"size\":1,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"IPs Over Time\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"timechart\"},\"name\":\"LA IPs Over Time\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"5f1dde0d-e3a4-4908-b7e1-05b9bcbf8844\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_ip_sort_order\",\"label\":\"Sort Order\",\"type\":10,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"asc\\\",\\\"desc\\\"]\",\"timeContext\":{\"durationMs\":86400000},\"value\":\"desc\"}],\"style\":\"formHorizontal\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"LA IP Sorting\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmIpAddressAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n|where isnotempty(IpBlocks_s)\\r\\n|extend IpBlocks_j = parse_json(IpBlocks_s)\\r\\n|extend ReversedBlock = array_reverse(IpBlocks_j)\\r\\n|extend IpBlock = array_slice(ReversedBlock,0,0)\\r\\n|extend IpBlock = tostring(strcat_array(IpBlock,''))\\r\\n|where isnotempty(IpBlock)\\r\\n|summarize Count=count() by IpBlock\\r\\n|sort by Count {_la_ip_sort_order}\",\"size\":0,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"IPs by Block\",\"showRefreshButton\":true,\"exportFieldName\":\"IpBlock\",\"exportParameterName\":\"_la_ip_block\",\"exportDefaultValue\":\"No IP Block Selected\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"tiles\",\"gridSettings\":{\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"IpBlock\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":true,\"sortOrderField\":1,\"size\":\"auto\"}},\"customWidth\":\"80\",\"name\":\"LA IPs by Block\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmIpAddressAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n|where IpBlocks_s has '{_la_ip_block}'\\r\\n|project-keep IPAddress\",\"size\":0,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"IPs Lookup for '{_la_ip_block}'\",\"noDataMessage\":\"Select an IP Block to find active IPs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":1000,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"IpBlock\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":true,\"sortOrderField\":1,\"size\":\"auto\"}},\"customWidth\":\"20\",\"name\":\"LA IPs Lookup by IP Block\"}]},\"conditionalVisibilities\":[{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Workspace Summary\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Risk Findings\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA CVEs\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Host Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Page Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA SSL Certificate Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Domain Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Web Components\"}],\"name\":\"LA IP Address Details\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"Page Details\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|where AssetType == 'PAGE'\\\\r\\\\n|summarize Count=count() by AssetType,SnapshotDateTime\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"Pages Over Time\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"timechart\"},\"name\":\"ADX Pages Over Time\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"5f1dde0d-e3a4-4908-b7e1-05b9bcbf8844\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_adx_page_sort_order\",\"label\":\"Sort Order\",\"type\":10,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"asc\\\",\\\"desc\\\"]\",\"timeContext\":{\"durationMs\":86400000},\"value\":\"asc\"}],\"style\":\"formHorizontal\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"ADX Page Sorting\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmPageAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n|where isnotempty(SiteStatus)\\\\r\\\\n|summarize Count=count() by SiteStatus\\\\r\\\\n|sort by Count {_adx_page_sort_order}\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":4,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"Pages by Site Status\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"SiteStatus\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":true,\"sortOrderField\":1,\"size\":\"auto\"}},\"customWidth\":\"50\",\"name\":\"ADX Pages by Site Status\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmPageAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n|extend ServicePort = todynamic(array_reverse(split(Service,':')))\\\\r\\\\n|mv-expand ServicePort limit 1\\\\r\\\\n|extend ServicePort = tostring(ServicePort)\\\\r\\\\n|extend Service = case(ServicePort == '443','HTTPS',ServicePort == '80','HTTP','OTHER')\\\\r\\\\n|summarize Count=count() by ServicePort,Service\\\\r\\\\n|sort by Count {_adx_page_sort_order}\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":4,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"Pages by Service\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"Service\",\"formatter\":1},\"subtitleContent\":{\"columnMatch\":\"ServicePort\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":true,\"sortOrderField\":1,\"size\":\"auto\"}},\"customWidth\":\"50\",\"name\":\"ADX Pages by Service\"}]},\"conditionalVisibilities\":[{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Workspace Summary\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Risk Findings\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX CVEs\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Host Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX IP Address Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX SSL Certificate Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Domain Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Web Components\"}],\"name\":\"ADX Page Details\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"Page Details\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|where AssetType_s == 'PAGE'\\r\\n|summarize Count=count() by AssetType_s,SnapshotDateTime_t\",\"size\":1,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"Pages Over Time\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"timechart\"},\"name\":\"LA Pages Over Time\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"5f1dde0d-e3a4-4908-b7e1-05b9bcbf8844\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"_la_page_sort_order\",\"label\":\"Sort Order\",\"type\":10,\"isRequired\":true,\"typeSettings\":{\"additionalResourceOptions\":[]},\"jsonData\":\"[\\\"asc\\\",\\\"desc\\\"]\",\"timeContext\":{\"durationMs\":86400000},\"value\":\"asc\"}],\"style\":\"formHorizontal\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"LA IP Sorting\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmPageAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n|where isnotempty(SiteStatus_s)\\r\\n|summarize Count=count() by SiteStatus_s\\r\\n|sort by Count {_la_page_sort_order}\",\"size\":4,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"Pages by Site Status\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"SiteStatus_s\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":true,\"sortOrderField\":1,\"size\":\"auto\"}},\"customWidth\":\"50\",\"name\":\"LA Pages by Site Status\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmPageAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n|extend ServicePort = todynamic(array_reverse(split(Service_s,':')))\\r\\n|mv-expand ServicePort limit 1\\r\\n|extend ServicePort = tostring(ServicePort)\\r\\n|extend Service = case(ServicePort == '443','HTTPS',ServicePort == '80','HTTP','OTHER')\\r\\n|summarize Count=count() by ServicePort,Service\\r\\n|sort by Count {_la_page_sort_order}\",\"size\":4,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"Pages by Service\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"Service\",\"formatter\":1},\"subtitleContent\":{\"columnMatch\":\"ServicePort\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"showBorder\":true,\"sortOrderField\":1,\"size\":\"auto\"}},\"customWidth\":\"50\",\"name\":\"LA Pages by Service\"}]},\"conditionalVisibilities\":[{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Workspace Summary\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Risk Findings\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA CVEs\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Host Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA IP Address Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA SSL Certificate Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Domain Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Web Components\"}],\"name\":\"LA Page Details\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"SSL Certificate Details\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|where AssetType == 'SSL_CERT'\\\\r\\\\n|summarize Count=count() by AssetType,SnapshotDateTime\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"SSL Certificates Over Time\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"timechart\"},\"name\":\"ADX SSL Certificates Over Time\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmRisk\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where MetricDisplayName contains \\\\\\\"certificates\\\\\\\"\\\\r\\\\n|extend ReversedAuditTrail = array_reverse(AssetDiscoveryAuditTrail)\\\\r\\\\n|project-away AssetDiscoveryAuditTrail, AssetLastSeen\\\\r\\\\n|mv-expand ReversedAuditTrail limit 1\\\\r\\\\n|join kind=inner (EasmSslCertAsset\\\\r\\\\n    | where WorkspaceName == workspace\\\\r\\\\n    | where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    | where (AssetLastSeen > InvalidAfter or (InvalidAfter > now() and InvalidAfter-30d < now()))\\\\r\\\\n    | extend Status = iff((AssetLastSeen > InvalidAfter),'Expired','Expiring in 30 days')\\\\r\\\\n    | extend CertCommonName = strcat_array(SubjectCommonNames,'')\\\\r\\\\n    | extend CertSha1 = AssetName\\\\r\\\\n    | project-keep AssetId, AssetLastSeen, CertCommonName, CertSha1, InvalidAfter,Status\\\\r\\\\n    ) on AssetId\\\\r\\\\n|project-keep ReversedAuditTrail,AssetLastSeen,CertCommonName,CertSha1,InvalidAfter,Status\\\\r\\\\n|extend AssetName = tostring(ReversedAuditTrail.AssetType)\\\\r\\\\n|project-away ReversedAuditTrail\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(AssetLastSeen, *) by AssetName,CertCommonName,CertSha1,InvalidAfter,Status\\\\r\\\\n|order by InvalidAfter asc\\\\r\\\\n|project-reorder AssetName,Status,InvalidAfter,AssetLastSeen\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\" SSL Certs Expired or Expiring Soon\",\"noDataMessage\":\"No expired or soon-to-expire certificates found\",\"showRefreshButton\":true,\"exportParameterName\":\"_asset_detail\",\"showExportToExcel\":true,\"queryType\":9,\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"customWidth\":\"50\",\"name\":\"ADX SSL Certs Expired or Expiring Soon\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmSslCertAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n|where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n|where IsSelfSigned == true\\\\r\\\\n|mv-expand SubjectCommonNames\\\\r\\\\n|extend CommonName = tostring(SubjectCommonNames)\\\\r\\\\n|join (EasmHostAsset\\\\r\\\\n    |where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |mv-expand SslCerts\\\\r\\\\n    |extend HostThumb = tostring(SslCerts)\\\\r\\\\n    |extend SeenOnHost = Host\\\\r\\\\n    |project-keep SeenOnHost,HostThumb\\\\r\\\\n) on $left.Thumbprint == $right.HostThumb\\\\r\\\\n|join (EasmIpAddressAsset\\\\r\\\\n    |where WorkspaceName == workspace\\\\r\\\\n    |where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n    |where AssetLastSeen {_adx_lastseen:query}\\\\r\\\\n    |mv-expand SslCerts\\\\r\\\\n    |extend IpThumb = tostring(SslCerts)\\\\r\\\\n    |extend SeenOnIp = IpAddress\\\\r\\\\n    |project-keep SeenOnIp,IpThumb\\\\r\\\\n) on $left.Thumbprint == $right.IpThumb\\\\r\\\\n|extend Sha1 = Thumbprint\\\\r\\\\n|project-keep CommonName,SeenOnHost,SeenOnIp,Sha1\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"aggregation\":2,\"showAnalytics\":true,\"title\":\"Self-Signed Certificates\",\"noDataMessage\":\"No self-signed certificates found\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Group\",\"formatter\":1}],\"filter\":true,\"hierarchySettings\":{\"treeType\":1,\"groupBy\":[\"CommonName\"],\"expandTopLevel\":false}},\"graphSettings\":{\"type\":2,\"topContent\":{\"columnMatch\":\"SeenOnHost\"},\"centerContent\":{\"columnMatch\":\"CommonName\"},\"bottomContent\":{\"columnMatch\":\"SeenOnIp\"},\"hivesContent\":{\"columnMatch\":\"CommonName\",\"formatter\":1},\"nodeIdField\":\"CommonName\",\"sourceIdField\":\"SeenOnHost\",\"targetIdField\":\"SeenOnIp\",\"graphOrientation\":3,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":{\"nodeColorField\":\"SeenOnIp\",\"type\":1,\"colorPalette\":\"default\"},\"groupByField\":\"CommonName\",\"hivesMargin\":5}},\"customWidth\":\"50\",\"name\":\"ADX Self-Signed Certificates\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmSslCertAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n|mv-expand IssuerOrganizations\\\\r\\\\n|where isnotempty(IssuerOrganizations)\\\\r\\\\n|extend Org = tostring(IssuerOrganizations)\\\\r\\\\n|summarize Count=count() by Org\\\\r\\\\n|sort by Count asc\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"aggregation\":2,\"showAnalytics\":true,\"title\":\"Certificate Issuer Orgs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"categoricalbar\"},\"customWidth\":\"50\",\"name\":\"ADX Certificate Issuer Orgs\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmSslCertAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n|mv-expand SubjectOrganizations\\\\r\\\\n|where isnotempty(SubjectOrganizations)\\\\r\\\\n|extend Org = tostring(SubjectOrganizations)\\\\r\\\\n|summarize Count=count() by Org\\\\r\\\\n|sort by Count asc\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":0,\"aggregation\":2,\"showAnalytics\":true,\"title\":\"Certificate Subject Orgs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"categoricalbar\"},\"customWidth\":\"50\",\"name\":\"ADX Certificate Subject Orgs\",\"styleSettings\":{\"showBorder\":true}}]},\"conditionalVisibilities\":[{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Workspace Summary\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Risk Findings\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX CVEs\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Host Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX IP Address Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Page Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Domain Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Web Components\"}],\"name\":\"ADX SSL Certificate Details\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"SSL Certificate Details\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|where AssetType_s == 'SSL_CERT'\\r\\n|summarize Count=count() by AssetType_s,SnapshotDateTime_t\",\"size\":1,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"SSL Certificates Over Time\",\"showRefreshButton\":true,\"exportParameterName\":\"_ssl_param\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"timechart\"},\"name\":\"LA SSL Certificates Over Time\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmRisk_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where MetricDisplayName_s contains \\\"certificates\\\"\\r\\n|extend ReversedAuditTrail = array_reverse(parse_json(AssetDiscoveryAuditTrail_s))\\r\\n|project-away AssetDiscoveryAuditTrail_s, AssetLastSeen_t\\r\\n|mv-expand ReversedAuditTrail limit 1\\r\\n|join kind=inner (EasmSslCertAsset_CL\\r\\n    | where WorkspaceName_s == workspace\\r\\n    | where AssetLastSeen_t {_la_lastseen:query}\\r\\n    | where (AssetLastSeen_t > InvalidAfter_t or (InvalidAfter_t > now() and InvalidAfter_t-30d < now()))\\r\\n    | extend Status = iff((AssetLastSeen_t > InvalidAfter_t),'Expired','Expiring in 30 days')\\r\\n    | extend CertCommonName = trim(@'[\\\\[\\\\]\\\\s\\\\\\\"]+',SubjectCommonNames_s)\\r\\n    //| extend CertCommonName = strcat_array(SubjectCommonNames,'')\\r\\n    | extend CertSha1 = AssetName_s\\r\\n    | project-keep AssetId_s, AssetLastSeen_t, CertCommonName, CertSha1, InvalidAfter_t, Status\\r\\n    ) on AssetId_s\\r\\n|project-keep ReversedAuditTrail,AssetLastSeen_t,CertCommonName,CertSha1,InvalidAfter_t,Status\\r\\n|extend AssetName = tostring(ReversedAuditTrail.AssetType)\\r\\n|project-away ReversedAuditTrail\\r\\n|summarize hint.strategy=shuffle arg_max(AssetLastSeen_t, *) by tostring(AssetName),CertCommonName,CertSha1,InvalidAfter_t,Status\\r\\n|order by InvalidAfter_t asc\\r\\n|project-reorder AssetName,Status,InvalidAfter_t,AssetLastSeen_t\",\"size\":1,\"showAnalytics\":true,\"title\":\" SSL Certs Expired or Expiring Soon\",\"noDataMessage\":\"No expired or soon-to-expire certificates found\",\"showRefreshButton\":true,\"exportParameterName\":\"_asset_detail\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"gridSettings\":{\"rowLimit\":1000,\"filter\":true}},\"customWidth\":\"50\",\"name\":\"LA SSL Certs Expired or Expiring Soon\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmSslCertAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n|where AssetLastSeen_t {_la_lastseen:query}\\r\\n|where IsSelfSigned_b == true\\r\\n|extend CommonName = trim(@'[\\\\[\\\\]\\\\s\\\\\\\"]+',SubjectCommonNames_s)\\r\\n|join (EasmHostAsset_CL\\r\\n    |where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(SslCerts_s)\\r\\n    |extend SslCerts_j = parse_json(SslCerts_s)\\r\\n    |mv-expand SslCerts_j\\r\\n    |extend HostThumb = tostring(SslCerts_j)\\r\\n    |extend SeenOnHost = AssetName_s\\r\\n    |project-keep SeenOnHost,HostThumb\\r\\n) on $left.Thumbprint_s == $right.HostThumb\\r\\n|join (EasmIpAddressAsset_CL\\r\\n    |where WorkspaceName_s == workspace\\r\\n    |where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n    |summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n    |where AssetLastSeen_t {_la_lastseen:query}\\r\\n    |where isnotempty(SslCerts_s)\\r\\n    |extend SslCerts_j = parse_json(SslCerts_s)\\r\\n    |mv-expand SslCerts_j\\r\\n    |extend IpThumb = tostring(SslCerts_j)\\r\\n    |extend SeenOnIp = AssetName_s\\r\\n    |project-keep SeenOnIp,IpThumb\\r\\n) on $left.Thumbprint_s == $right.IpThumb\\r\\n|extend Sha1 = Thumbprint_s\\r\\n|project-keep CommonName,SeenOnHost,SeenOnIp,Sha1\",\"size\":1,\"aggregation\":2,\"showAnalytics\":true,\"title\":\"Self-Signed Certificates\",\"noDataMessage\":\"No self-signed certificates found\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Group\",\"formatter\":1}],\"filter\":true,\"hierarchySettings\":{\"treeType\":1,\"groupBy\":[\"CommonName\"],\"expandTopLevel\":false}},\"graphSettings\":{\"type\":2,\"topContent\":{\"columnMatch\":\"SeenOnHost\"},\"centerContent\":{\"columnMatch\":\"CommonName\"},\"bottomContent\":{\"columnMatch\":\"SeenOnIp\"},\"hivesContent\":{\"columnMatch\":\"CommonName\",\"formatter\":1},\"nodeIdField\":\"CommonName\",\"sourceIdField\":\"SeenOnHost\",\"targetIdField\":\"SeenOnIp\",\"graphOrientation\":3,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":{\"nodeColorField\":\"SeenOnIp\",\"type\":1,\"colorPalette\":\"default\"},\"groupByField\":\"CommonName\",\"hivesMargin\":5}},\"customWidth\":\"50\",\"name\":\"LA Self-Signed Certificates\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmSslCertAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n|where isnotempty(IssuerOrganizations_s)\\r\\n|extend IssuerOrganizations_j = parse_json(IssuerOrganizations_s)\\r\\n|mv-expand IssuerOrganizations_j\\r\\n|where isnotempty(IssuerOrganizations_j)\\r\\n|extend Org = tostring(IssuerOrganizations_j)\\r\\n|summarize Count=count() by Org\\r\\n|sort by Count asc\",\"size\":0,\"aggregation\":2,\"showAnalytics\":true,\"title\":\"Certificate Issuer Orgs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"categoricalbar\"},\"customWidth\":\"50\",\"name\":\"LA Certificate Issuer Orgs\",\"styleSettings\":{\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmSslCertAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n|where isnotempty(SubjectOrganizations_s)\\r\\n|extend SubjectOrganizations_j = parse_json(SubjectOrganizations_s)\\r\\n|mv-expand SubjectOrganizations_j\\r\\n|where isnotempty(SubjectOrganizations_j)\\r\\n|extend Org = tostring(SubjectOrganizations_j)\\r\\n|summarize Count=count() by Org\\r\\n|sort by Count asc\",\"size\":0,\"aggregation\":2,\"showAnalytics\":true,\"title\":\"Certificate Subject Orgs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"categoricalbar\"},\"customWidth\":\"50\",\"name\":\"LA Certificate Subject Orgs\",\"styleSettings\":{\"showBorder\":true}}]},\"conditionalVisibilities\":[{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Workspace Summary\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Risk Findings\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA CVEs\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Host Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA IP Address Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Page Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Domain Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Web Components\"}],\"name\":\"LA SSL Certificate Details\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"Domain Details\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|where AssetType == 'DOMAIN'\\\\r\\\\n|summarize Count=count() by AssetType,SnapshotDateTime\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"Domains Over Time\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"timechart\",\"chartSettings\":{\"group\":null,\"createOtherGroup\":0}},\"name\":\"ADX Domains Over Time\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmDomainAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|extend OrgName=array_concat(AdminOrgs,RegistrantOrgs,TechnicalOrgs)\\\\r\\\\n|mv-expand OrgName\\\\r\\\\n|where isnotempty(OrgName)\\\\r\\\\n|summarize AllDomains=make_set(AssetName) by tostring(OrgName)\\\\r\\\\n|extend Count=array_length(AllDomains)\\\\r\\\\n|project-reorder OrgName,Count\\\\r\\\\n|sort by Count desc\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"Domains by Org Name\",\"showRefreshButton\":true,\"exportFieldName\":\"\",\"exportParameterName\":\"_adx_org_name\",\"exportDefaultValue\":\"{\\\"OrgName\\\":\\\"\\\"}\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":1000,\"filter\":true},\"chartSettings\":{\"group\":null,\"createOtherGroup\":0}},\"customWidth\":\"70\",\"name\":\"ADX Domains by Org Name\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nlet orgname = tostring(dynamic({_adx_org_name}).OrgName);\\\\r\\\\nEasmDomainAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|extend OrgName=array_concat(AdminOrgs,RegistrantOrgs,TechnicalOrgs)\\\\r\\\\n|mv-expand OrgName\\\\r\\\\n|where isnotempty(OrgName) and OrgName == orgname\\\\r\\\\n|summarize arg_max(SnapshotDateTime, *) by Domain\\\\r\\\\n|project Domain\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"Domains List by Org Name\",\"noDataMessage\":\"Select a row from Domains by Org Name\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":1000},\"chartSettings\":{\"group\":null,\"createOtherGroup\":0}},\"customWidth\":\"30\",\"name\":\"ADX Domains by Org Name_Domain List\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmDomainAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n|mv-expand AdminOrgs \\\\r\\\\n|where isnotempty(AdminOrgs)\\\\r\\\\n|extend Org = tostring(AdminOrgs)\\\\r\\\\n|summarize Count=count() by Org\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":3,\"showAnalytics\":true,\"title\":\"Admin Orgs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"chartSettings\":{\"group\":\"Org\",\"createOtherGroup\":8},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"ADX Admin Orgs\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmDomainAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n|mv-expand RegistrantOrgs \\\\r\\\\n|where isnotempty(RegistrantOrgs)\\\\r\\\\n|extend Org = tostring(RegistrantOrgs)\\\\r\\\\n|summarize Count=count() by Org\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":3,\"showAnalytics\":true,\"title\":\"Registrant Orgs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"chartSettings\":{\"group\":\"Org\",\"createOtherGroup\":8},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"ADX Registrant Orgs\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmDomainAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n|mv-expand TechnicalOrgs \\\\r\\\\n|where isnotempty(TechnicalOrgs)\\\\r\\\\n|extend Org = tostring(TechnicalOrgs)\\\\r\\\\n|summarize Count=count() by Org\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":3,\"showAnalytics\":true,\"title\":\"Technical Orgs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"chartSettings\":{\"group\":\"Org\",\"createOtherGroup\":8},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"ADX Technical Orgs\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmDomainAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|extend ContactEmail=array_concat(AdminContacts,RegistrantContacts,TechnicalContacts)\\\\r\\\\n|mv-expand ContactEmail\\\\r\\\\n|where isnotempty(ContactEmail)\\\\r\\\\n//|join kind=leftsemi EasmContactAsset on $left.ContactEmail == $right.Email\\\\r\\\\n|summarize AllDomains=make_set(AssetName) by tostring(ContactEmail)\\\\r\\\\n|extend Count=array_length(AllDomains)\\\\r\\\\n|project-reorder ContactEmail,Count\\\\r\\\\n|sort by Count desc\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\"Domains by Contact Email\",\"showRefreshButton\":true,\"exportFieldName\":\"ContactEmail\",\"exportParameterName\":\"_adx_contact_email\",\"exportDefaultValue\":\"\\\"\\\"\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":1000,\"filter\":true},\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"chartSettings\":{\"group\":\"Org\",\"createOtherGroup\":8},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"70\",\"name\":\"ADX Domains by Contact Email\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmDomainAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|extend ContactEmail=array_concat(AdminContacts,RegistrantContacts,TechnicalContacts)\\\\r\\\\n|mv-expand ContactEmail\\\\r\\\\n|where ContactEmail == '{_adx_contact_email}'\\\\r\\\\n|summarize arg_max(SnapshotDateTime, *) by Domain\\\\r\\\\n|project Domain\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":1,\"showAnalytics\":true,\"title\":\"Domains List by Contact Email\",\"noDataMessage\":\"Select a row from Domains by Contact Email\",\"showRefreshButton\":true,\"exportFieldName\":\"ContactEmail\",\"exportParameterName\":\"_adx_contact_email\",\"exportDefaultValue\":\"this@that.other\",\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":1000},\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"chartSettings\":{\"group\":\"Org\",\"createOtherGroup\":8},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"30\",\"name\":\"ADX Domains by Contact Email_Domain List\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmDomainAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n|mv-expand AdminContacts \\\\r\\\\n|where isnotempty(AdminContacts)\\\\r\\\\n|extend Contact = tostring(AdminContacts)\\\\r\\\\n|summarize Count=count() by Contact\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":3,\"showAnalytics\":true,\"title\":\"Admin Contacts\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"chartSettings\":{\"group\":\"Contact\",\"createOtherGroup\":8},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"ADX Admin Contacts\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmDomainAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n|mv-expand AdminContacts \\\\r\\\\n|where isnotempty(AdminContacts)\\\\r\\\\n|extend Contact = tostring(AdminContacts)\\\\r\\\\n|summarize Count=count() by Contact\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":3,\"showAnalytics\":true,\"title\":\"Registrant Contacts\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"chartSettings\":{\"group\":\"Contact\",\"createOtherGroup\":8},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"ADX Registrant Contacts\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"{\\\"version\\\":\\\"AzureDataExplorerQuery/1.0\\\",\\\"queryText\\\":\\\"let workspace = '{_adx_workspace_name}';\\\\r\\\\nEasmDomainAsset\\\\r\\\\n|where WorkspaceName == workspace\\\\r\\\\n|where SnapshotDateTime != '{_adx_oldest_snapshot}'\\\\r\\\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime, *) by AssetId\\\\r\\\\n|mv-expand TechnicalContacts \\\\r\\\\n|where isnotempty(TechnicalContacts)\\\\r\\\\n|extend Contact = tostring(TechnicalContacts)\\\\r\\\\n|summarize Count=count() by Contact\\\",\\\"clusterName\\\":\\\"{_adx_cluster_uri}\\\",\\\"databaseName\\\":\\\"{_adx_database_name}\\\"}\",\"size\":3,\"showAnalytics\":true,\"title\":\"Technical Contacts\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":9,\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"chartSettings\":{\"group\":\"Contact\",\"createOtherGroup\":8},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"ADX Technical Contacts\"}]},\"conditionalVisibilities\":[{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Azure Data Explorer\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Workspace Summary\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Risk Findings\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX CVEs\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Host Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX IP Address Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Page Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX SSL Certificate Details\"},{\"parameterName\":\"_adx_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"ADX Web Components\"}],\"name\":\"ADX Domain Details\",\"styleSettings\":{\"showBorder\":true}},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"title\":\"Domain Details\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|where AssetType_s == 'DOMAIN'\\r\\n|summarize Count=count() by AssetType_s,SnapshotDateTime_t\",\"size\":1,\"aggregation\":5,\"showAnalytics\":true,\"title\":\"Domains Over Time\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"timechart\",\"chartSettings\":{\"group\":null,\"createOtherGroup\":0}},\"name\":\"LA Domains Over Time\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmDomainAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|extend OrgName=array_concat(todynamic(AdminOrgs_s),todynamic(RegistrantOrgs_s),todynamic(TechnicalOrgs_s))\\r\\n|mv-expand OrgName\\r\\n|where isnotempty(OrgName)\\r\\n|summarize AllDomains=make_set(AssetName_s) by tostring(OrgName)\\r\\n|extend Count=array_length(AllDomains)\\r\\n|project-reorder OrgName,Count\\r\\n|sort by Count desc\",\"size\":1,\"showAnalytics\":true,\"title\":\"Domains by Org Name\",\"showRefreshButton\":true,\"exportFieldName\":\"\",\"exportParameterName\":\"_la_org_name\",\"exportDefaultValue\":\"{\\\"OrgName\\\":\\\"\\\"}\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":1000,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"AllContacts\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"}},\"showBorder\":false},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"70\",\"name\":\"LA Domains by Org Name\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nlet orgname = tostring(dynamic({_la_org_name}).OrgName);\\r\\nEasmDomainAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|extend OrgName=array_concat(todynamic(AdminOrgs_s),todynamic(RegistrantOrgs_s),todynamic(TechnicalOrgs_s))\\r\\n|mv-expand OrgName\\r\\n|where isnotempty(OrgName) and OrgName == orgname\\r\\n|summarize arg_max(SnapshotDateTime_t, *) by Domain_s\\r\\n|project Domain_s\",\"size\":1,\"showAnalytics\":true,\"title\":\"Domains List by Org Name\",\"noDataMessage\":\"Select a row from Domains by Org Name\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":1000},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"AllContacts\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"}},\"showBorder\":false},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"30\",\"name\":\"LA Domains by Org Name_Domain List\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmDomainAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n|where isnotempty(AdminOrgs_s)\\r\\n|extend AdminOrgs_j = parse_json(AdminOrgs_s)\\r\\n|mv-expand AdminOrgs_j \\r\\n|where isnotempty(AdminOrgs_j)\\r\\n|extend Org = tostring(AdminOrgs_j)\\r\\n|summarize Count=count() by Org\",\"size\":3,\"showAnalytics\":true,\"title\":\"Admin Orgs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"chartSettings\":{\"group\":\"Org\",\"createOtherGroup\":8},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"LA Admin Orgs\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmDomainAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n|where isnotempty(RegistrantOrgs_s)\\r\\n|extend RegistrantOrgs_j = parse_json(RegistrantOrgs_s)\\r\\n|mv-expand RegistrantOrgs_j \\r\\n|where isnotempty(RegistrantOrgs_j)\\r\\n|extend Org = tostring(RegistrantOrgs_j)\\r\\n|summarize Count=count() by Org\",\"size\":3,\"showAnalytics\":true,\"title\":\"Registrant Orgs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"chartSettings\":{\"group\":\"Org\",\"createOtherGroup\":8},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"LA Registrant Orgs\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmDomainAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n|where isnotempty(TechnicalOrgs_s)\\r\\n|extend TechnicalOrgs_j = parse_json(TechnicalOrgs_s)\\r\\n|mv-expand TechnicalOrgs_j \\r\\n|where isnotempty(TechnicalOrgs_j)\\r\\n|extend Org = tostring(TechnicalOrgs_j)\\r\\n|summarize Count=count() by Org\",\"size\":3,\"showAnalytics\":true,\"title\":\"Technical Orgs\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"chartSettings\":{\"group\":\"Org\",\"createOtherGroup\":8},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"LA Technical Orgs\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmDomainAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|extend ContactEmail=array_concat(todynamic(AdminContacts_s),todynamic(RegistrantContacts_s),todynamic(TechnicalContacts_s))\\r\\n|mv-expand ContactEmail\\r\\n|where isnotempty(ContactEmail)\\r\\n//|join kind=leftsemi EasmContactAsset_CL on $left.ContactEmail == $right.Email_s\\r\\n|summarize AllDomains=make_set(AssetName_s) by tostring(ContactEmail)\\r\\n|extend Count=array_length(AllDomains)\\r\\n|project-reorder ContactEmail,Count\\r\\n|sort by Count desc\",\"size\":1,\"showAnalytics\":true,\"title\":\"Domains by Contact Email\",\"showRefreshButton\":true,\"exportFieldName\":\"ContactEmail\",\"exportParameterName\":\"_la_contact_email\",\"exportDefaultValue\":\"this@that.other\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":1000,\"filter\":true},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"AllContacts\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"}},\"showBorder\":false},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"70\",\"name\":\"LA Domains by Contact Email\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmDomainAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|extend ContactEmail=array_concat(todynamic(AdminContacts_s),todynamic(RegistrantContacts_s),todynamic(TechnicalContacts_s))\\r\\n|mv-expand ContactEmail\\r\\n|where ContactEmail == '{_la_contact_email}'\\r\\n//|join kind=leftsemi (EasmContactAsset_CL) on $left.ContactEmail == $right.Email_s\\r\\n|summarize arg_max(SnapshotDateTime_t, *) by Domain_s\\r\\n|project Domain_s\",\"size\":1,\"showAnalytics\":true,\"title\":\"Domains List by Contact Email\",\"noDataMessage\":\"Select a row from Domains by Contact Email\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"table\",\"gridSettings\":{\"rowLimit\":1000},\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"AllContacts\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"}},\"showBorder\":false},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"30\",\"name\":\"LA Domains by Contact Email_Domain List\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmDomainAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n|where isnotempty(AdminContacts_s)\\r\\n|extend AdminContacts_j = parse_json(AdminContacts_s)\\r\\n|mv-expand AdminContacts_j \\r\\n|where isnotempty(AdminContacts_j)\\r\\n|extend Contact = tostring(AdminContacts_j)\\r\\n|summarize Count=count() by Contact\",\"size\":3,\"showAnalytics\":true,\"title\":\"Admin Contacts\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"chartSettings\":{\"group\":\"Contact\",\"createOtherGroup\":8},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"LA Admin Contacts\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmDomainAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n|where isnotempty(RegistrantContacts_s)\\r\\n|extend RegistrantContacts_j = parse_json(RegistrantContacts_s)\\r\\n|mv-expand RegistrantContacts_j \\r\\n|where isnotempty(RegistrantContacts_j)\\r\\n|extend Contact = tostring(RegistrantContacts_j)\\r\\n|summarize Count=count() by Contact\",\"size\":3,\"showAnalytics\":true,\"title\":\"Registrant Contacts\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"chartSettings\":{\"group\":\"Contact\",\"createOtherGroup\":8},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"LA Registrant Contacts\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"let workspace = '{_la_workspace_name}';\\r\\nEasmDomainAsset_CL\\r\\n|where WorkspaceName_s == workspace\\r\\n|where SnapshotDateTime_t != '{_la_oldest_snapshot}'\\r\\n|summarize hint.strategy=shuffle arg_max(SnapshotDateTime_t, *) by AssetId_s\\r\\n|where isnotempty(TechnicalContacts_s)\\r\\n|extend TechnicalContacts_j = parse_json(TechnicalContacts_s)\\r\\n|mv-expand TechnicalContacts_j \\r\\n|where isnotempty(TechnicalContacts_j)\\r\\n|extend Contact = tostring(TechnicalContacts_j)\\r\\n|summarize Count=count() by Contact\",\"size\":3,\"showAnalytics\":true,\"title\":\"Technical Contacts\",\"showRefreshButton\":true,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"{_la_workspace}\"],\"visualization\":\"piechart\",\"tileSettings\":{\"showBorder\":false,\"titleContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"leftContent\":{\"columnMatch\":\"Count\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}}},\"graphSettings\":{\"type\":0,\"topContent\":{\"columnMatch\":\"AdminOrgs\",\"formatter\":1},\"centerContent\":{\"columnMatch\":\"Count\",\"formatter\":1,\"numberFormat\":{\"unit\":17,\"options\":{\"maximumSignificantDigits\":3,\"maximumFractionDigits\":2}}},\"nodeIdField\":\"AdminOrgs\",\"sourceIdField\":\"AdminOrgs\",\"targetIdField\":\"AdminOrgs\",\"graphOrientation\":1,\"showOrientationToggles\":false,\"nodeSize\":null,\"staticNodeSize\":100,\"colorSettings\":null,\"groupByField\":\"AdminOrgs\",\"hivesMargin\":5},\"chartSettings\":{\"group\":\"Contact\",\"createOtherGroup\":8},\"mapSettings\":{\"locInfo\":\"LatLong\",\"sizeSettings\":\"Count\",\"sizeAggregation\":\"Sum\",\"legendMetric\":\"Count\",\"legendAggregation\":\"Sum\",\"itemColorSettings\":{\"type\":\"heatmap\",\"colorAggregation\":\"Sum\",\"nodeColorField\":\"Count\",\"heatmapPalette\":\"greenRed\"}}},\"customWidth\":\"33\",\"name\":\"LA Technical Contacts\"}]},\"conditionalVisibilities\":[{\"parameterName\":\"_workbook_source\",\"comparison\":\"isEqualTo\",\"value\":\"Log Analytics\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Workspace Summary\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Risk Findings\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA CVEs\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Host Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA IP Address Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Page Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA SSL Certificate Details\"},{\"parameterName\":\"_la_layout\",\"comparison\":\"isNotEqualTo\",\"value\":\"LA Web Components\"}],\"name\":\"LA Domain Details\",\"styleSettings\":{\"showBorder\":true}}],\"isLocked\":false,\"fallbackResourceIds\":[\"\"],\"fromTemplateId\":\"sentinel-UserWorkbook\"}",
        "version": "1.0",
        "sourceId": "[variables('workbookSourceId')]",
        "category": "[parameters('workbookType')]"
      }
    }
  ],
  "outputs": {
    "workbookId": {
      "type": "string",
      "value": "[resourceId( 'microsoft.insights/workbooks', parameters('workbookId'))]"
    }
  },
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"
}
